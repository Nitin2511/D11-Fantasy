<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T20 World Cup 2026 Fantasy Contest</title>
    
    <!-- React -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Firebase v9 -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0a0e27 100%);
            color: #fff;
            min-height: 100vh;
        }
        
        #root {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            padding: 50px 20px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-radius: 25px;
            margin-bottom: 40px;
            box-shadow: 0 30px 60px rgba(16, 185, 129, 0.4);
        }
        
        .header h1 {
            font-family: 'Rajdhani', sans-serif;
            font-size: 3.5rem;
            font-weight: 700;
            letter-spacing: 4px;
            text-shadow: 4px 4px 8px rgba(0,0,0,0.5);
        }

        .logout-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background: rgba(255,255,255,0.2);
            border: 2px solid white;
            color: white;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .login-container {
            max-width: 450px;
            margin: 100px auto;
            background: linear-gradient(135deg, #1a1f3a 0%, #242b4a 100%);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }

        .login-container h2 {
            font-family: 'Rajdhani', sans-serif;
            font-size: 2rem;
            margin-bottom: 30px;
            color: #10b981;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #cbd5e1;
            font-weight: 600;
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            background: #0a0e27;
            border: 2px solid #2d3548;
            border-radius: 12px;
            color: white;
            font-size: 16px;
        }

        .form-group input:focus {
            outline: none;
            border-color: #10b981;
        }

        .error-message {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid #ef4444;
            color: #fca5a5;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 35px;
            background: #1a1f3a;
            padding: 12px;
            border-radius: 20px;
            flex-wrap: wrap;
        }
        
        .tab {
            flex: 1;
            min-width: 140px;
            padding: 18px;
            background: transparent;
            border: none;
            color: #8892b0;
            font-weight: 600;
            cursor: pointer;
            border-radius: 12px;
            transition: all 0.3s;
            font-size: 16px;
            font-family: 'Rajdhani', sans-serif;
        }
        
        .tab.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.5);
        }
        
        .card {
            background: linear-gradient(135deg, #1a1f3a 0%, #242b4a 100%);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }
        
        .card h2 {
            font-family: 'Rajdhani', sans-serif;
            font-size: 2rem;
            margin-bottom: 25px;
            color: #10b981;
        }

        .btn {
            padding: 15px 35px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 700;
            cursor: pointer;
            font-size: 17px;
            transition: all 0.3s;
            font-family: 'Rajdhani', sans-serif;
            width: 100%;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.6);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .match-card {
            background: #0a0e27;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 2px solid #2d3548;
            cursor: pointer;
            transition: all 0.3s;
        }

        .match-card:hover {
            border-color: #10b981;
            transform: translateY(-2px);
        }

        .match-card.selected {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }

        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .team-names {
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .match-info {
            display: flex;
            gap: 20px;
            font-size: 0.9rem;
            color: #8892b0;
            margin-top: 10px;
        }

        .team-count {
            background: #0a0e27;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 2px solid #2d3548;
        }

        .role-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .role-tab {
            padding: 12px 24px;
            background: #0a0e27;
            border: 2px solid #2d3548;
            border-radius: 10px;
            color: #cbd5e1;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .role-tab.active {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
            color: #10b981;
        }

        .players-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .player-card {
            background: #0a0e27;
            padding: 18px;
            border-radius: 12px;
            border: 2px solid #2d3548;
            cursor: pointer;
            transition: all 0.3s;
        }

        .player-card:hover {
            border-color: #10b981;
        }

        .player-card.selected {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }

        .player-card.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .player-name {
            font-weight: 700;
            margin-bottom: 6px;
            color: #fff;
            font-size: 1.05rem;
        }

        .player-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .player-role {
            font-size: 0.85rem;
            color: #8892b0;
            background: #1a1f3a;
            padding: 4px 8px;
            border-radius: 4px;
        }

        .player-credits {
            font-size: 0.9rem;
            color: #10b981;
            font-weight: 700;
        }

        .player-team {
            font-size: 0.8rem;
            color: #60a5fa;
            margin-bottom: 8px;
        }

        .captain-buttons {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .captain-btn {
            flex: 1;
            padding: 8px;
            background: #2d3548;
            border: none;
            border-radius: 6px;
            color: #cbd5e1;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.3s;
        }

        .captain-btn.active-captain {
            background: #10b981;
            color: white;
        }

        .captain-btn.active-vc {
            background: #3b82f6;
            color: white;
        }

        .validation-error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid #ef4444;
            color: #fca5a5;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .validation-error ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .my-teams-list {
            display: grid;
            gap: 20px;
        }

        .team-item {
            background: #0a0e27;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #2d3548;
        }

        .team-item h4 {
            color: #10b981;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .team-players {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
        }

        .team-player-name {
            background: #1a1f3a;
            padding: 10px;
            border-radius: 8px;
            font-size: 0.95rem;
        }

        .search-box {
            width: 100%;
            padding: 12px 15px;
            background: #0a0e27;
            border: 2px solid #2d3548;
            border-radius: 10px;
            color: white;
            font-size: 14px;
            margin-bottom: 20px;
        }

        .search-box:focus {
            outline: none;
            border-color: #10b981;
        }

        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2rem;
            color: #8892b0;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ===== FIREBASE CONFIGURATION =====
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "t20-fantasy-contest",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }

        const db = firebase.firestore();
        const auth = firebase.auth();

        // ===== COMPLETE T20 WORLD CUP 2026 DATA =====
        
        const TEAMS_DATA = {
            IND: { name: "India", short: "IND", color: "#0066CC" },
            PAK: { name: "Pakistan", short: "PAK", color: "#008000" },
            AUS: { name: "Australia", short: "AUS", color: "#FFD700" },
            ENG: { name: "England", short: "ENG", color: "#002FA7" },
            NZ: { name: "New Zealand", short: "NZ", color: "#000000" },
            SA: { name: "South Africa", short: "SA", color: "#007A4D" },
            WI: { name: "West Indies", short: "WI", color: "#7B0046" },
            SL: { name: "Sri Lanka", short: "SL", color: "#003DA5" },
            BAN: { name: "Bangladesh", short: "BAN", color: "#006A4E" },
            AFG: { name: "Afghanistan", short: "AFG", color: "#D32011" },
            IRE: { name: "Ireland", short: "IRE", color: "#169B62" },
            NED: { name: "Netherlands", short: "NED", color: "#FF6600" },
            ZIM: { name: "Zimbabwe", short: "ZIM", color: "#FFD100" },
            OMA: { name: "Oman", short: "OMA", color: "#ED1C24" },
            USA: { name: "USA", short: "USA", color: "#B22234" },
            NAM: { name: "Namibia", short: "NAM", color: "#003580" },
            UAE: { name: "UAE", short: "UAE", color: "#00732F" },
            CAN: { name: "Canada", short: "CAN", color: "#FF0000" },
            NEP: { name: "Nepal", short: "NEP", color: "#DC143C" },
            ITA: { name: "Italy", short: "ITA", color: "#009246" }
        };

        const PLAYERS = {
            // INDIA
            IND: [
                { id: "ind1", name: "Suryakumar Yadav", role: "BAT", credits: 9.5 },
                { id: "ind2", name: "Abhishek Sharma", role: "BAT", credits: 8.0 },
                { id: "ind3", name: "Tilak Varma", role: "BAT", credits: 8.5 },
                { id: "ind4", name: "Sanju Samson", role: "WK", credits: 9.0 },
                { id: "ind5", name: "Ishan Kishan", role: "WK", credits: 8.5 },
                { id: "ind6", name: "Hardik Pandya", role: "AR", credits: 9.5 },
                { id: "ind7", name: "Shivam Dube", role: "AR", credits: 8.0 },
                { id: "ind8", name: "Rinku Singh", role: "BAT", credits: 8.0 },
                { id: "ind9", name: "Axar Patel", role: "AR", credits: 8.5 },
                { id: "ind10", name: "Washington Sundar", role: "AR", credits: 7.5 },
                { id: "ind11", name: "Jasprit Bumrah", role: "BOWL", credits: 10.0 },
                { id: "ind12", name: "Arshdeep Singh", role: "BOWL", credits: 8.5 },
                { id: "ind13", name: "Mohammed Siraj", role: "BOWL", credits: 8.5 },
                { id: "ind14", name: "Varun Chakaravarthy", role: "BOWL", credits: 8.0 },
                { id: "ind15", name: "Kuldeep Yadav", role: "BOWL", credits: 8.0 }
            ],
            // PAKISTAN
            PAK: [
                { id: "pak1", name: "Babar Azam", role: "BAT", credits: 9.5 },
                { id: "pak2", name: "Saim Ayub", role: "BAT", credits: 8.0 },
                { id: "pak3", name: "Fakhar Zaman", role: "BAT", credits: 8.5 },
                { id: "pak4", name: "Mohammad Rizwan", role: "WK", credits: 9.0 },
                { id: "pak5", name: "Usman Khan", role: "WK", credits: 7.5 },
                { id: "pak6", name: "Salman Ali Agha", role: "AR", credits: 8.0 },
                { id: "pak7", name: "Shadab Khan", role: "AR", credits: 8.5 },
                { id: "pak8", name: "Faheem Ashraf", role: "AR", credits: 7.5 },
                { id: "pak9", name: "Mohammad Nawaz", role: "AR", credits: 7.5 },
                { id: "pak10", name: "Shaheen Shah Afridi", role: "BOWL", credits: 9.5 },
                { id: "pak11", name: "Naseem Shah", role: "BOWL", credits: 9.0 },
                { id: "pak12", name: "Haris Rauf", role: "BOWL", credits: 8.5 },
                { id: "pak13", name: "Abrar Ahmed", role: "BOWL", credits: 7.5 },
                { id: "pak14", name: "Khawaja Nafay", role: "BAT", credits: 7.0 },
                { id: "pak15", name: "Sahibzada Farhan", role: "BAT", credits: 7.0 }
            ],
            // AUSTRALIA
            AUS: [
                { id: "aus1", name: "Travis Head", role: "BAT", credits: 9.0 },
                { id: "aus2", name: "Mitchell Marsh", role: "AR", credits: 9.0 },
                { id: "aus3", name: "Glenn Maxwell", role: "AR", credits: 9.5 },
                { id: "aus4", name: "Marcus Stoinis", role: "AR", credits: 8.5 },
                { id: "aus5", name: "Cameron Green", role: "AR", credits: 8.5 },
                { id: "aus6", name: "Tim David", role: "BAT", credits: 8.0 },
                { id: "aus7", name: "Josh Inglis", role: "WK", credits: 8.5 },
                { id: "aus8", name: "Matthew Wade", role: "WK", credits: 8.0 },
                { id: "aus9", name: "Adam Zampa", role: "BOWL", credits: 9.0 },
                { id: "aus10", name: "Nathan Ellis", role: "BOWL", credits: 7.5 },
                { id: "aus11", name: "Pat Cummins", role: "BOWL", credits: 9.0 },
                { id: "aus12", name: "Mitchell Starc", role: "BOWL", credits: 9.5 },
                { id: "aus13", name: "Josh Hazlewood", role: "BOWL", credits: 8.5 },
                { id: "aus14", name: "Sean Abbott", role: "AR", credits: 7.5 },
                { id: "aus15", name: "Ashton Agar", role: "AR", credits: 7.0 }
            ],
            // ENGLAND
            ENG: [
                { id: "eng1", name: "Jos Buttler", role: "WK", credits: 9.5 },
                { id: "eng2", name: "Phil Salt", role: "WK", credits: 8.5 },
                { id: "eng3", name: "Harry Brook", role: "BAT", credits: 9.0 },
                { id: "eng4", name: "Ben Duckett", role: "BAT", credits: 8.0 },
                { id: "eng5", name: "Jonny Bairstow", role: "WK", credits: 8.5 },
                { id: "eng6", name: "Liam Livingstone", role: "AR", credits: 8.5 },
                { id: "eng7", name: "Sam Curran", role: "AR", credits: 9.0 },
                { id: "eng8", name: "Moeen Ali", role: "AR", credits: 8.0 },
                { id: "eng9", name: "Chris Woakes", role: "AR", credits: 8.0 },
                { id: "eng10", name: "Jofra Archer", role: "BOWL", credits: 9.5 },
                { id: "eng11", name: "Mark Wood", role: "BOWL", credits: 8.5 },
                { id: "eng12", name: "Adil Rashid", role: "BOWL", credits: 9.0 },
                { id: "eng13", name: "Rehan Ahmed", role: "BOWL", credits: 7.5 },
                { id: "eng14", name: "Will Jacks", role: "AR", credits: 7.5 },
                { id: "eng15", name: "Tom Banton", role: "BAT", credits: 7.0 }
            ],
            // Add remaining teams with 15 players each...
            NZ: [
                { id: "nz1", name: "Kane Williamson", role: "BAT", credits: 9.0 },
                { id: "nz2", name: "Devon Conway", role: "WK", credits: 8.5 },
                { id: "nz3", name: "Finn Allen", role: "BAT", credits: 8.0 },
                { id: "nz4", name: "Glenn Phillips", role: "AR", credits: 8.5 },
                { id: "nz5", name: "Daryl Mitchell", role: "AR", credits: 8.5 },
                { id: "nz6", name: "Mark Chapman", role: "BAT", credits: 7.5 },
                { id: "nz7", name: "Mitchell Santner", role: "AR", credits: 8.0 },
                { id: "nz8", name: "Jimmy Neesham", role: "AR", credits: 7.5 },
                { id: "nz9", name: "Tim Seifert", role: "WK", credits: 7.0 },
                { id: "nz10", name: "Trent Boult", role: "BOWL", credits: 9.0 },
                { id: "nz11", name: "Lockie Ferguson", role: "BOWL", credits: 8.5 },
                { id: "nz12", name: "Tim Southee", role: "BOWL", credits: 8.5 },
                { id: "nz13", name: "Ish Sodhi", role: "BOWL", credits: 8.0 },
                { id: "nz14", name: "Matt Henry", role: "BOWL", credits: 7.5 },
                { id: "nz15", name: "Rachin Ravindra", role: "AR", credits: 8.0 }
            ],
            SA: [
                { id: "sa1", name: "Quinton de Kock", role: "WK", credits: 9.0 },
                { id: "sa2", name: "Aiden Markram", role: "BAT", credits: 8.5 },
                { id: "sa3", name: "Tristan Stubbs", role: "BAT", credits: 8.0 },
                { id: "sa4", name: "David Miller", role: "BAT", credits: 9.0 },
                { id: "sa5", name: "Heinrich Klaasen", role: "WK", credits: 9.0 },
                { id: "sa6", name: "Marco Jansen", role: "AR", credits: 8.5 },
                { id: "sa7", name: "Andile Phehlukwayo", role: "AR", credits: 7.5 },
                { id: "sa8", name: "Keshav Maharaj", role: "BOWL", credits: 8.0 },
                { id: "sa9", name: "Kagiso Rabada", role: "BOWL", credits: 9.5 },
                { id: "sa10", name: "Anrich Nortje", role: "BOWL", credits: 9.0 },
                { id: "sa11", name: "Lungi Ngidi", role: "BOWL", credits: 8.5 },
                { id: "sa12", name: "Tabraiz Shamsi", role: "BOWL", credits: 8.0 },
                { id: "sa13", name: "Reeza Hendricks", role: "BAT", credits: 7.5 },
                { id: "sa14", name: "Rassie van der Dussen", role: "BAT", credits: 8.0 },
                { id: "sa15", name: "Dewald Brevis", role: "BAT", credits: 7.5 }
            ],
            WI: [
                { id: "wi1", name: "Nicholas Pooran", role: "WK", credits: 9.0 },
                { id: "wi2", name: "Brandon King", role: "BAT", credits: 8.0 },
                { id: "wi3", name: "Rovman Powell", role: "AR", credits: 8.5 },
                { id: "wi4", name: "Andre Russell", role: "AR", credits: 9.0 },
                { id: "wi5", name: "Shimron Hetmyer", role: "BAT", credits: 8.0 },
                { id: "wi6", name: "Shai Hope", role: "WK", credits: 8.5 },
                { id: "wi7", name: "Jason Holder", role: "AR", credits: 8.5 },
                { id: "wi8", name: "Romario Shepherd", role: "AR", credits: 7.5 },
                { id: "wi9", name: "Akeal Hosein", role: "BOWL", credits: 8.0 },
                { id: "wi10", name: "Alzarri Joseph", role: "BOWL", credits: 8.5 },
                { id: "wi11", name: "Obed McCoy", role: "BOWL", credits: 7.5 },
                { id: "wi12", name: "Gudakesh Motie", role: "BOWL", credits: 7.5 },
                { id: "wi13", name: "Kyle Mayers", role: "AR", credits: 8.0 },
                { id: "wi14", name: "Johnson Charles", role: "WK", credits: 7.5 },
                { id: "wi15", name: "Shamar Joseph", role: "BOWL", credits: 7.0 }
            ],
            SL: [
                { id: "sl1", name: "Pathum Nissanka", role: "BAT", credits: 8.5 },
                { id: "sl2", name: "Kusal Mendis", role: "WK", credits: 8.5 },
                { id: "sl3", name: "Charith Asalanka", role: "BAT", credits: 8.0 },
                { id: "sl4", name: "Wanindu Hasaranga", role: "AR", credits: 9.5 },
                { id: "sl5", name: "Dasun Shanaka", role: "AR", credits: 8.0 },
                { id: "sl6", name: "Kamindu Mendis", role: "AR", credits: 7.5 },
                { id: "sl7", name: "Angelo Mathews", role: "AR", credits: 8.0 },
                { id: "sl8", name: "Maheesh Theekshana", role: "BOWL", credits: 8.5 },
                { id: "sl9", name: "Matheesha Pathirana", role: "BOWL", credits: 8.0 },
                { id: "sl10", name: "Dushmantha Chameera", role: "BOWL", credits: 8.0 },
                { id: "sl11", name: "Dunith Wellalage", role: "AR", credits: 7.5 },
                { id: "sl12", name: "Kusal Perera", role: "WK", credits: 7.5 },
                { id: "sl13", name: "Sadeera Samarawickrama", role: "BAT", credits: 7.0 },
                { id: "sl14", name: "Dilshan Madushanka", role: "BOWL", credits: 8.0 },
                { id: "sl15", name: "Jeffrey Vandersay", role: "BOWL", credits: 7.0 }
            ],
            BAN: [
                { id: "ban1", name: "Shakib Al Hasan", role: "AR", credits: 9.0 },
                { id: "ban2", name: "Litton Das", role: "WK", credits: 8.5 },
                { id: "ban3", name: "Najmul Hossain Shanto", role: "BAT", credits: 8.0 },
                { id: "ban4", name: "Towhid Hridoy", role: "BAT", credits: 8.0 },
                { id: "ban5", name: "Mehidy Hasan Miraz", role: "AR", credits: 8.5 },
                { id: "ban6", name: "Mahmudullah", role: "AR", credits: 7.5 },
                { id: "ban7", name: "Soumya Sarkar", role: "AR", credits: 7.5 },
                { id: "ban8", name: "Taskin Ahmed", role: "BOWL", credits: 8.5 },
                { id: "ban9", name: "Mustafizur Rahman", role: "BOWL", credits: 9.0 },
                { id: "ban10", name: "Tanzim Hasan Sakib", role: "BOWL", credits: 7.5 },
                { id: "ban11", name: "Rishad Hossain", role: "BOWL", credits: 7.5 },
                { id: "ban12", name: "Tanzid Hasan", role: "BAT", credits: 7.5 },
                { id: "ban13", name: "Jaker Ali", role: "WK", credits: 7.0 },
                { id: "ban14", name: "Afif Hossain", role: "AR", credits: 7.0 },
                { id: "ban15", name: "Shoriful Islam", role: "BOWL", credits: 7.5 }
            ],
            AFG: [
                { id: "afg1", name: "Rashid Khan", role: "BOWL", credits: 10.0 },
                { id: "afg2", name: "Rahmanullah Gurbaz", role: "WK", credits: 8.5 },
                { id: "afg3", name: "Ibrahim Zadran", role: "BAT", credits: 8.0 },
                { id: "afg4", name: "Mohammad Nabi", role: "AR", credits: 8.5 },
                { id: "afg5", name: "Azmatullah Omarzai", role: "AR", credits: 8.0 },
                { id: "afg6", name: "Gulbadin Naib", role: "AR", credits: 7.5 },
                { id: "afg7", name: "Najibullah Zadran", role: "BAT", credits: 8.0 },
                { id: "afg8", name: "Noor Ahmad", role: "BOWL", credits: 8.0 },
                { id: "afg9", name: "Mujeeb Ur Rahman", role: "BOWL", credits: 8.5 },
                { id: "afg10", name: "Fazalhaq Farooqi", role: "BOWL", credits: 8.5 },
                { id: "afg11", name: "Naveen-ul-Haq", role: "BOWL", credits: 8.0 },
                { id: "afg12", name: "Mohammad Ishaq", role: "WK", credits: 7.0 },
                { id: "afg13", name: "Sediqullah Atal", role: "BAT", credits: 7.0 },
                { id: "afg14", name: "Shahidullah Kamal", role: "AR", credits: 7.0 },
                { id: "afg15", name: "Abdullah Ahmadzai", role: "BOWL", credits: 7.0 }
            ],
            // Continue for all 20 teams...
            IRE: [
                { id: "ire1", name: "Paul Stirling", role: "BAT", credits: 8.5 },
                { id: "ire2", name: "Lorcan Tucker", role: "WK", credits: 7.5 },
                { id: "ire3", name: "Harry Tector", role: "BAT", credits: 8.0 },
                { id: "ire4", name: "Curtis Campher", role: "AR", credits: 7.5 },
                { id: "ire5", name: "George Dockrell", role: "AR", credits: 7.5 },
                { id: "ire6", name: "Mark Adair", role: "AR", credits: 8.0 },
                { id: "ire7", name: "Josh Little", role: "BOWL", credits: 8.0 },
                { id: "ire8", name: "Barry McCarthy", role: "BOWL", credits: 7.0 },
                { id: "ire9", name: "Craig Young", role: "BOWL", credits: 7.0 },
                { id: "ire10", name: "Gareth Delany", role: "AR", credits: 7.0 },
                { id: "ire11", name: "Ross Adair", role: "BAT", credits: 7.0 },
                { id: "ire12", name: "Andy McBrine", role: "AR", credits: 7.0 },
                { id: "ire13", name: "Ben White", role: "BOWL", credits: 6.5 },
                { id: "ire14", name: "Matthew Humphreys", role: "BOWL", credits: 6.5 },
                { id: "ire15", name: "Tim Tector", role: "BAT", credits: 6.5 }
            ],
            NED: [
                { id: "ned1", name: "Scott Edwards", role: "WK", credits: 7.5 },
                { id: "ned2", name: "Max O'Dowd", role: "BAT", credits: 7.5 },
                { id: "ned3", name: "Bas de Leede", role: "AR", credits: 8.0 },
                { id: "ned4", name: "Colin Ackermann", role: "AR", credits: 7.5 },
                { id: "ned5", name: "Roelof van der Merwe", role: "AR", credits: 7.5 },
                { id: "ned6", name: "Logan van Beek", role: "AR", credits: 7.5 },
                { id: "ned7", name: "Paul van Meekeren", role: "BOWL", credits: 7.5 },
                { id: "ned8", name: "Aryan Dutt", role: "BOWL", credits: 7.0 },
                { id: "ned9", name: "Vivian Kingma", role: "BOWL", credits: 7.0 },
                { id: "ned10", name: "Tim Pringle", role: "BOWL", credits: 7.0 },
                { id: "ned11", name: "Vikramjit Singh", role: "BAT", credits: 7.0 },
                { id: "ned12", name: "Michael Levitt", role: "BAT", credits: 6.5 },
                { id: "ned13", name: "Saqib Zulfiqar", role: "AR", credits: 6.5 },
                { id: "ned14", name: "Kyle Klein", role: "BOWL", credits: 6.5 },
                { id: "ned15", name: "Noah Croes", role: "BAT", credits: 6.5 }
            ],
            ZIM: [
                { id: "zim1", name: "Sikandar Raza", role: "AR", credits: 8.5 },
                { id: "zim2", name: "Craig Ervine", role: "BAT", credits: 7.5 },
                { id: "zim3", name: "Sean Williams", role: "AR", credits: 7.5 },
                { id: "zim4", name: "Blessing Muzarabani", role: "BOWL", credits: 7.5 },
                { id: "zim5", name: "Richard Ngarava", role: "BOWL", credits: 7.0 },
                { id: "zim6", name: "Ryan Burl", role: "AR", credits: 7.0 },
                { id: "zim7", name: "Regis Chakabva", role: "WK", credits: 7.0 },
                { id: "zim8", name: "Tendai Chatara", role: "BOWL", credits: 7.0 },
                { id: "zim9", name: "Wellington Masakadza", role: "AR", credits: 7.0 },
                { id: "zim10", name: "Luke Jongwe", role: "AR", credits: 7.0 },
                { id: "zim11", name: "Milton Shumba", role: "BAT", credits: 6.5 },
                { id: "zim12", name: "Clive Madande", role: "WK", credits: 6.5 },
                { id: "zim13", name: "Wessly Madhevere", role: "AR", credits: 7.0 },
                { id: "zim14", name: "Bradley Evans", role: "BOWL", credits: 6.5 },
                { id: "zim15", name: "Brian Bennett", role: "BAT", credits: 6.5 }
            ],
            OMA: [
                { id: "oma1", name: "Aqib Ilyas", role: "AR", credits: 7.5 },
                { id: "oma2", name: "Jatinder Singh", role: "BAT", credits: 7.5 },
                { id: "oma3", name: "Kashyap Prajapati", role: "WK", credits: 7.0 },
                { id: "oma4", name: "Ayaan Khan", role: "AR", credits: 7.5 },
                { id: "oma5", name: "Mohammad Nadeem", role: "BAT", credits: 7.0 },
                { id: "oma6", name: "Bilal Khan", role: "BOWL", credits: 7.5 },
                { id: "oma7", name: "Kaleemullah", role: "BOWL", credits: 7.5 },
                { id: "oma8", name: "Fayyaz Butt", role: "AR", credits: 7.0 },
                { id: "oma9", name: "Shakeel Ahmad", role: "WK", credits: 6.5 },
                { id: "oma10", name: "Pratik Athavale", role: "BAT", credits: 6.5 },
                { id: "oma11", name: "Mehran Khan", role: "BOWL", credits: 7.0 },
                { id: "oma12", name: "Jay Odedra", role: "BOWL", credits: 6.5 },
                { id: "oma13", name: "Wasim Ali", role: "AR", credits: 6.5 },
                { id: "oma14", name: "Sufyan Mehmood", role: "BOWL", credits: 6.5 },
                { id: "oma15", name: "Hammad Mirza", role: "AR", credits: 6.5 }
            ],
            USA: [
                { id: "usa1", name: "Monank Patel", role: "WK", credits: 7.5 },
                { id: "usa2", name: "Aaron Jones", role: "BAT", credits: 8.0 },
                { id: "usa3", name: "Andries Gous", role: "WK", credits: 7.0 },
                { id: "usa4", name: "Corey Anderson", role: "AR", credits: 8.0 },
                { id: "usa5", name: "Harmeet Singh", role: "AR", credits: 7.0 },
                { id: "usa6", name: "Nosthush Kenjige", role: "BOWL", credits: 7.0 },
                { id: "usa7", name: "Saurabh Netravalkar", role: "BOWL", credits: 7.5 },
                { id: "usa8", name: "Ali Khan", role: "BOWL", credits: 7.5 },
                { id: "usa9", name: "Jessy Singh", role: "AR", credits: 6.5 },
                { id: "usa10", name: "Milind Kumar", role: "BAT", credits: 6.5 },
                { id: "usa11", name: "Shayan Jahangir", role: "BAT", credits: 6.5 },
                { id: "usa12", name: "Shadley Van Schalkwyk", role: "BOWL", credits: 6.5 },
                { id: "usa13", name: "Nisarg Patel", role: "BOWL", credits: 6.5 },
                { id: "usa14", name: "Smit Patel", role: "WK", credits: 6.5 },
                { id: "usa15", name: "Steven Taylor", role: "BAT", credits: 7.0 }
            ],
            NAM: [
                { id: "nam1", name: "Gerhard Erasmus", role: "AR", credits: 7.5 },
                { id: "nam2", name: "David Wiese", role: "AR", credits: 8.0 },
                { id: "nam3", name: "JJ Smit", role: "AR", credits: 7.5 },
                { id: "nam4", name: "Zane Green", role: "WK", credits: 7.0 },
                { id: "nam5", name: "Ruben Trumpelmann", role: "BOWL", credits: 7.5 },
                { id: "nam6", name: "Bernard Scholtz", role: "BOWL", credits: 7.0 },
                { id: "nam7", name: "Michael van Lingen", role: "BAT", credits: 7.0 },
                { id: "nam8", name: "Nicol Loftie-Eaton", role: "AR", credits: 7.0 },
                { id: "nam9", name: "Jan Frylinck", role: "AR", credits: 7.0 },
                { id: "nam10", name: "Tangeni Lungameni", role: "BOWL", credits: 6.5 },
                { id: "nam11", name: "Ben Shikongo", role: "BOWL", credits: 6.5 },
                { id: "nam12", name: "Jack Brassell", role: "BOWL", credits: 6.5 },
                { id: "nam13", name: "Malan Kruger", role: "BAT", credits: 6.5 },
                { id: "nam14", name: "Pikky Ya France", role: "BAT", credits: 6.5 },
                { id: "nam15", name: "Louren Steenkamp", role: "AR", credits: 6.5 }
            ],
            UAE: [
                { id: "uae1", name: "Muhammad Waseem", role: "BAT", credits: 7.5 },
                { id: "uae2", name: "Vriitya Aravind", role: "WK", credits: 7.0 },
                { id: "uae3", name: "CP Rizwan", role: "AR", credits: 7.0 },
                { id: "uae4", name: "Basil Hameed", role: "AR", credits: 7.0 },
                { id: "uae5", name: "Aayan Afzal Khan", role: "BOWL", credits: 7.0 },
                { id: "uae6", name: "Junaid Siddique", role: "AR", credits: 6.5 },
                { id: "uae7", name: "Rohan Mustafa", role: "AR", credits: 6.5 },
                { id: "uae8", name: "Zahoor Khan", role: "BOWL", credits: 7.0 },
                { id: "uae9", name: "Ali Naseer", role: "AR", credits: 6.5 },
                { id: "uae10", name: "Muhammad Jawadullah", role: "BOWL", credits: 7.0 },
                { id: "uae11", name: "Aryansh Sharma", role: "BAT", credits: 6.5 },
                { id: "uae12", name: "Alishan Sharafu", role: "BAT", credits: 6.5 },
                { id: "uae13", name: "Tanish Suri", role: "WK", credits: 6.5 },
                { id: "uae14", name: "Karthik Meiyappan", role: "BOWL", credits: 7.0 },
                { id: "uae15", name: "Sanchit Sharma", role: "BOWL", credits: 6.5 }
            ],
            CAN: [
                { id: "can1", name: "Nicholas Kirton", role: "BAT", credits: 7.0 },
                { id: "can2", name: "Aaron Johnson", role: "BAT", credits: 7.0 },
                { id: "can3", name: "Navneet Dhaliwal", role: "AR", credits: 7.5 },
                { id: "can4", name: "Shreyas Movva", role: "WK", credits: 7.0 },
                { id: "can5", name: "Pargat Singh", role: "BAT", credits: 6.5 },
                { id: "can6", name: "Saad Bin Zafar", role: "AR", credits: 7.5 },
                { id: "can7", name: "Dillon Heyliger", role: "BOWL", credits: 7.0 },
                { id: "can8", name: "Jeremy Gordon", role: "BOWL", credits: 7.0 },
                { id: "can9", name: "Kaleem Sana", role: "BOWL", credits: 7.0 },
                { id: "can10", name: "Nikhil Dutta", role: "BOWL", credits: 6.5 },
                { id: "can11", name: "Harsh Thaker", role: "AR", credits: 6.5 },
                { id: "can12", name: "Dilpreet Bajwa", role: "BAT", credits: 6.5 },
                { id: "can13", name: "Ravinderpal Singh", role: "AR", credits: 6.5 },
                { id: "can14", name: "Rishiv Joshi", role: "BAT", credits: 6.5 },
                { id: "can15", name: "Rayyankhan Pathan", role: "AR", credits: 6.5 }
            ],
            NEP: [
                { id: "nep1", name: "Rohit Paudel", role: "BAT", credits: 7.5 },
                { id: "nep2", name: "Kushal Bhurtel", role: "BAT", credits: 7.5 },
                { id: "nep3", name: "Aasif Sheikh", role: "WK", credits: 7.5 },
                { id: "nep4", name: "Dipendra Singh Airee", role: "AR", credits: 7.5 },
                { id: "nep5", name: "Sompal Kami", role: "AR", credits: 7.0 },
                { id: "nep6", name: "Karan KC", role: "BOWL", credits: 7.0 },
                { id: "nep7", name: "Sandeep Lamichhane", role: "BOWL", credits: 8.0 },
                { id: "nep8", name: "Gulsan Jha", role: "BOWL", credits: 6.5 },
                { id: "nep9", name: "Abinash Bohara", role: "BOWL", credits: 6.5 },
                { id: "nep10", name: "Lalit Rajbanshi", role: "BOWL", credits: 6.5 },
                { id: "nep11", name: "Kushal Malla", role: "BAT", credits: 7.0 },
                { id: "nep12", name: "Aarif Sheikh", role: "AR", credits: 7.0 },
                { id: "nep13", name: "Sundeep Jora", role: "AR", credits: 6.5 },
                { id: "nep14", name: "Pratish GC", role: "BAT", credits: 6.5 },
                { id: "nep15", name: "Lokesh Bam", role: "BAT", credits: 6.5 }
            ],
            ITA: [
                { id: "ita1", name: "Grant Stewart", role: "BOWL", credits: 7.0 },
                { id: "ita2", name: "JJ Smuts", role: "AR", credits: 7.5 },
                { id: "ita3", name: "Marcus Campopiano", role: "WK", credits: 7.0 },
                { id: "ita4", name: "Harry Manenti", role: "AR", credits: 7.0 },
                { id: "ita5", name: "Wayne Madsen", role: "BAT", credits: 7.0 },
                { id: "ita6", name: "Gian Meade", role: "BAT", credits: 6.5 },
                { id: "ita7", name: "Justin Mosca", role: "AR", credits: 6.5 },
                { id: "ita8", name: "Anthony Mosca", role: "AR", credits: 6.5 },
                { id: "ita9", name: "Jaspreet Singh", role: "BOWL", credits: 7.0 },
                { id: "ita10", name: "Amir Sharif", role: "BOWL", credits: 6.5 },
                { id: "ita11", name: "Baljit Singh", role: "AR", credits: 6.5 },
                { id: "ita12", name: "Zain Ali", role: "BAT", credits: 6.5 },
                { id: "ita13", name: "Thomas Draca", role: "BOWL", credits: 6.5 },
                { id: "ita14", name: "Crishan Kalugamage", role: "AR", credits: 6.5 },
                { id: "ita15", name: "Carl Sandri", role: "BAT", credits: 6.5 }
            ]
        };

        // ALL MATCHES - T20 WORLD CUP 2026
        const ALL_MATCHES = [
            // Group A
            { id: "m1", team1: "NED", team2: "PAK", date: "Feb 7, 2026", time: "11:00 AM", venue: "Colombo (SSC)", group: "A" },
            { id: "m2", team1: "IND", team2: "USA", date: "Feb 7, 2026", time: "7:00 PM", venue: "Wankhede", group: "A" },
            { id: "m3", team1: "NAM", team2: "NED", date: "Feb 10, 2026", time: "11:00 AM", venue: "Delhi", group: "A" },
            { id: "m4", team1: "PAK", team2: "USA", date: "Feb 10, 2026", time: "7:00 PM", venue: "Colombo (SSC)", group: "A" },
            { id: "m5", team1: "IND", team2: "NAM", date: "Feb 12, 2026", time: "7:00 PM", venue: "Delhi", group: "A" },
            { id: "m6", team1: "NED", team2: "USA", date: "Feb 13, 2026", time: "7:00 PM", venue: "Chennai", group: "A" },
            { id: "m7", team1: "NAM", team2: "USA", date: "Feb 15, 2026", time: "3:00 PM", venue: "Chennai", group: "A" },
            { id: "m8", team1: "IND", team2: "PAK", date: "Feb 15, 2026", time: "7:00 PM", venue: "Colombo (RPS)", group: "A" },
            { id: "m9", team1: "NAM", team2: "PAK", date: "Feb 18, 2026", time: "3:00 PM", venue: "Colombo (SSC)", group: "A" },
            { id: "m10", team1: "IND", team2: "NED", date: "Feb 18, 2026", time: "7:00 PM", venue: "Ahmedabad", group: "A" },
            
            // Group B
            { id: "m11", team1: "SL", team2: "IRE", date: "Feb 8, 2026", time: "7:00 PM", venue: "Colombo (RPS)", group: "B" },
            { id: "m12", team1: "OMA", team2: "ZIM", date: "Feb 9, 2026", time: "3:00 PM", venue: "Colombo (SSC)", group: "B" },
            { id: "m13", team1: "AUS", team2: "IRE", date: "Feb 11, 2026", time: "3:00 PM", venue: "Colombo (RPS)", group: "B" },
            { id: "m14", team1: "SL", team2: "OMA", date: "Feb 12, 2026", time: "11:00 AM", venue: "Pallekele", group: "B" },
            { id: "m15", team1: "AUS", team2: "ZIM", date: "Feb 13, 2026", time: "11:00 AM", venue: "Colombo (RPS)", group: "B" },
            { id: "m16", team1: "IRE", team2: "OMA", date: "Feb 14, 2026", time: "11:00 AM", venue: "Colombo (SSC)", group: "B" },
            { id: "m17", team1: "AUS", team2: "SL", date: "Feb 16, 2026", time: "7:00 PM", venue: "Pallekele", group: "B" },
            { id: "m18", team1: "IRE", team2: "ZIM", date: "Feb 17, 2026", time: "3:00 PM", venue: "Pallekele", group: "B" },
            { id: "m19", team1: "SL", team2: "ZIM", date: "Feb 19, 2026", time: "3:00 PM", venue: "Colombo (RPS)", group: "B" },
            { id: "m20", team1: "AUS", team2: "OMA", date: "Feb 20, 2026", time: "7:00 PM", venue: "Pallekele", group: "B" },
            
            // Group C
            { id: "m21", team1: "BAN", team2: "WI", date: "Feb 7, 2026", time: "3:00 PM", venue: "Eden Gardens", group: "C" },
            { id: "m22", team1: "ENG", team2: "NEP", date: "Feb 8, 2026", time: "3:00 PM", venue: "Wankhede", group: "C" },
            { id: "m23", team1: "BAN", team2: "ITA", date: "Feb 9, 2026", time: "11:00 AM", venue: "Eden Gardens", group: "C" },
            { id: "m24", team1: "ENG", team2: "WI", date: "Feb 11, 2026", time: "7:00 PM", venue: "Wankhede", group: "C" },
            { id: "m25", team1: "ITA", team2: "NEP", date: "Feb 12, 2026", time: "3:00 PM", venue: "Wankhede", group: "C" },
            { id: "m26", team1: "BAN", team2: "ENG", date: "Feb 14, 2026", time: "3:00 PM", venue: "Eden Gardens", group: "C" },
            { id: "m27", team1: "NEP", team2: "WI", date: "Feb 15, 2026", time: "11:00 AM", venue: "Wankhede", group: "C" },
            { id: "m28", team1: "ENG", team2: "ITA", date: "Feb 16, 2026", time: "3:00 PM", venue: "Eden Gardens", group: "C" },
            { id: "m29", team1: "BAN", team2: "NEP", date: "Feb 17, 2026", time: "7:00 PM", venue: "Wankhede", group: "C" },
            { id: "m30", team1: "ITA", team2: "WI", date: "Feb 19, 2026", time: "11:00 AM", venue: "Eden Gardens", group: "C" },
            
            // Group D
            { id: "m31", team1: "AFG", team2: "NZ", date: "Feb 8, 2026", time: "11:00 AM", venue: "Chennai", group: "D" },
            { id: "m32", team1: "CAN", team2: "SA", date: "Feb 9, 2026", time: "7:00 PM", venue: "Ahmedabad", group: "D" },
            { id: "m33", team1: "NZ", team2: "UAE", date: "Feb 10, 2026", time: "3:00 PM", venue: "Chennai", group: "D" },
            { id: "m34", team1: "AFG", team2: "SA", date: "Feb 11, 2026", time: "11:00 AM", venue: "Ahmedabad", group: "D" },
            { id: "m35", team1: "CAN", team2: "UAE", date: "Feb 13, 2026", time: "3:00 PM", venue: "Delhi", group: "D" },
            { id: "m36", team1: "NZ", team2: "SA", date: "Feb 14, 2026", time: "7:00 PM", venue: "Ahmedabad", group: "D" },
            { id: "m37", team1: "AFG", team2: "UAE", date: "Feb 16, 2026", time: "11:00 AM", venue: "Delhi", group: "D" },
            { id: "m38", team1: "CAN", team2: "NZ", date: "Feb 17, 2026", time: "11:00 AM", venue: "Chennai", group: "D" },
            { id: "m39", team1: "SA", team2: "UAE", date: "Feb 18, 2026", time: "11:00 AM", venue: "Delhi", group: "D" },
            { id: "m40", team1: "AFG", team2: "CAN", date: "Feb 19, 2026", time: "7:00 PM", venue: "Chennai", group: "D" }
        ];

        // ===== MAIN APP COMPONENT =====
        function App() {
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);
            const [activeTab, setActiveTab] = useState('matches');
            const [selectedMatch, setSelectedMatch] = useState(null);
            const [selectedPlayers, setSelectedPlayers] = useState([]);
            const [captain, setCaptain] = useState(null);
            const [viceCaptain, setViceCaptain] = useState(null);
            const [activeRole, setActiveRole] = useState('ALL');
            const [searchTerm, setSearchTerm] = useState('');
            const [myTeams, setMyTeams] = useState({});
            const [validationErrors, setValidationErrors] = useState([]);

            // Check auth state
            useEffect(() => {
                const unsubscribe = auth.onAuthStateChanged((firebaseUser) => {
                    setUser(firebaseUser);
                    setLoading(false);
                });
                return () => unsubscribe();
            }, []);

            // Load user's teams
            useEffect(() => {
                if (user) {
                    loadUserTeams();
                }
            }, [user]);

            const loadUserTeams = async () => {
                if (!user) return;
                
                try {
                    const teamsSnapshot = await db.collection('teams')
                        .where('userId', '==', user.uid)
                        .get();
                    
                    const teams = {};
                    teamsSnapshot.forEach(doc => {
                        const data = doc.data();
                        teams[data.matchId] = {
                            ...data,
                            id: doc.id
                        };
                    });
                    setMyTeams(teams);
                } catch (error) {
                    console.error('Error loading teams:', error);
                }
            };

            const getAvailablePlayers = () => {
                if (!selectedMatch) return [];
                
                const team1Players = PLAYERS[selectedMatch.team1] || [];
                const team2Players = PLAYERS[selectedMatch.team2] || [];
                
                return [...team1Players, ...team2Players].map(p => ({
                    ...p,
                    team: PLAYERS[selectedMatch.team1].includes(p) ? selectedMatch.team1 : selectedMatch.team2
                }));
            };

            const validateTeam = () => {
                const errors = [];
                
                // Check 11 players
                if (selectedPlayers.length !== 11) {
                    errors.push(`Select exactly 11 players (currently ${selectedPlayers.length})`);
                }
                
                // Check credits
                const totalCredits = selectedPlayers.reduce((sum, p) => sum + p.credits, 0);
                if (totalCredits > 100) {
                    errors.push(`Total credits ${totalCredits.toFixed(1)} exceeds limit of 100`);
                }
                
                // Check role distribution
                const roleCounts = {
                    WK: selectedPlayers.filter(p => p.role === 'WK').length,
                    BAT: selectedPlayers.filter(p => p.role === 'BAT').length,
                    AR: selectedPlayers.filter(p => p.role === 'AR').length,
                    BOWL: selectedPlayers.filter(p => p.role === 'BOWL').length
                };
                
                if (roleCounts.WK < 1 || roleCounts.WK > 4) errors.push(`Select 1-4 Wicket-Keepers (current: ${roleCounts.WK})`);
                if (roleCounts.BAT < 3 || roleCounts.BAT > 6) errors.push(`Select 3-6 Batsmen (current: ${roleCounts.BAT})`);
                if (roleCounts.AR < 1 || roleCounts.AR > 4) errors.push(`Select 1-4 All-Rounders (current: ${roleCounts.AR})`);
                if (roleCounts.BOWL < 3 || roleCounts.BOWL > 6) errors.push(`Select 3-6 Bowlers (current: ${roleCounts.BOWL})`);
                
                // Check team distribution (max 7 from one team)
                const team1Count = selectedPlayers.filter(p => p.team === selectedMatch.team1).length;
                const team2Count = selectedPlayers.filter(p => p.team === selectedMatch.team2).length;
                
                if (team1Count > 7) errors.push(`Maximum 7 players from ${TEAMS_DATA[selectedMatch.team1].name} (current: ${team1Count})`);
                if (team2Count > 7) errors.push(`Maximum 7 players from ${TEAMS_DATA[selectedMatch.team2].name} (current: ${team2Count})`);
                
                // Check captain and vice-captain
                if (!captain) errors.push('Select a Captain');
                if (!viceCaptain) errors.push('Select a Vice-Captain');
                if (captain && viceCaptain && captain === viceCaptain) errors.push('Captain and Vice-Captain must be different');
                
                return errors;
            };

            const togglePlayer = (player) => {
                const isSelected = selectedPlayers.find(p => p.id === player.id);
                
                if (isSelected) {
                    setSelectedPlayers(selectedPlayers.filter(p => p.id !== player.id));
                    if (captain === player.id) setCaptain(null);
                    if (viceCaptain === player.id) setViceCaptain(null);
                } else {
                    if (selectedPlayers.length < 11) {
                        setSelectedPlayers([...selectedPlayers, player]);
                    }
                }
                setValidationErrors([]);
            };

            const saveTeam = async () => {
                const errors = validateTeam();
                
                if (errors.length > 0) {
                    setValidationErrors(errors);
                    return;
                }
                
                try {
                    const teamData = {
                        userId: user.uid,
                        matchId: selectedMatch.id,
                        matchName: `${TEAMS_DATA[selectedMatch.team1].name} vs ${TEAMS_DATA[selectedMatch.team2].name}`,
                        matchDate: selectedMatch.date,
                        players: selectedPlayers,
                        captain,
                        viceCaptain,
                        totalCredits: selectedPlayers.reduce((sum, p) => sum + p.credits, 0),
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    };
                    
                    if (myTeams[selectedMatch.id]) {
                        // Update existing team
                        await db.collection('teams').doc(myTeams[selectedMatch.id].id).update(teamData);
                    } else {
                        // Create new team
                        await db.collection('teams').add(teamData);
                    }
                    
                    alert('Team saved successfully!');
                    await loadUserTeams();
                    setSelectedMatch(null);
                    setSelectedPlayers([]);
                    setCaptain(null);
                    setViceCaptain(null);
                    setActiveTab('myTeams');
                } catch (error) {
                    console.error('Error saving team:', error);
                    alert('Error saving team. Please try again.');
                }
            };

            const filteredPlayers = getAvailablePlayers().filter(player => {
                const matchesRole = activeRole === 'ALL' || player.role === activeRole;
                const matchesSearch = player.name.toLowerCase().includes(searchTerm.toLowerCase());
                return matchesRole && matchesSearch;
            });

            const getRoleCount = (role) => selectedPlayers.filter(p => p.role === role).length;
            const getTeamCount = (team) => selectedPlayers.filter(p => p.team === team).length;
            const totalCredits = selectedPlayers.reduce((sum, p) => sum + p.credits, 0);

            if (loading) {
                return <div className="loading">Loading...</div>;
            }

            if (!user) {
                return <LoginForm setUser={setUser} />;
            }

            return (
                <div>
                    <div className="header" style={{ position: 'relative' }}>
                        <button className="logout-btn" onClick={() => auth.signOut()}>
                            Logout
                        </button>
                        <h1> T20 WORLD CUP 2026</h1>
                        <p>Welcome, {user.displayName || user.email}!</p>
                    </div>

                    <div className="tabs">
                        <button
                            className={`tab ${activeTab === 'matches' ? 'active' : ''}`}
                            onClick={() => setActiveTab('matches')}
                        >
                            MATCHES
                        </button>
                        <button
                            className={`tab ${activeTab === 'myTeams' ? 'active' : ''}`}
                            onClick={() => setActiveTab('myTeams')}
                        >
                            MY TEAMS ({Object.keys(myTeams).length})
                        </button>
                    </div>

                    {activeTab === 'matches' && (
                        <div className="card">
                            <h2>Select Match</h2>
                            
                            {ALL_MATCHES.map(match => (
                                <div
                                    key={match.id}
                                    className={`match-card ${selectedMatch?.id === match.id ? 'selected' : ''}`}
                                    onClick={() => {
                                        setSelectedMatch(match);
                                        setSelectedPlayers([]);
                                        setCaptain(null);
                                        setViceCaptain(null);
                                        setValidationErrors([]);
                                        setActiveRole('ALL');
                                        setSearchTerm('');
                                    }}
                                >
                                    <div className="match-header">
                                        <div className="team-names">
                                            {TEAMS_DATA[match.team1].name} vs {TEAMS_DATA[match.team2].name}
                                        </div>
                                        {myTeams[match.id] && (
                                            <span style={{ color: '#10b981', fontWeight: '700', fontSize: '0.9rem' }}>
                                                 Team Created
                                            </span>
                                        )}
                                    </div>
                                    <div className="match-info">
                                        <span> {match.date}</span>
                                        <span> {match.time}</span>
                                        <span> {match.venue}</span>
                                        <span style={{ color: '#10b981' }}>Group {match.group}</span>
                                    </div>
                                </div>
                            ))}

                            {selectedMatch && (
                                <div style={{ marginTop: '40px' }}>
                                    <h2>Create Your Team ({selectedPlayers.length}/11)</h2>
                                    
                                    <div className="team-count">
                                        <div>
                                            <strong>WK:</strong> {getRoleCount('WK')} | 
                                            <strong> BAT:</strong> {getRoleCount('BAT')} | 
                                            <strong> AR:</strong> {getRoleCount('AR')} | 
                                            <strong> BOWL:</strong> {getRoleCount('BOWL')}
                                        </div>
                                        <div>
                                            <strong style={{ color: totalCredits > 100 ? '#ef4444' : '#10b981' }}>
                                                Credits: {totalCredits.toFixed(1)}/100
                                            </strong>
                                        </div>
                                    </div>

                                    <div className="team-count" style={{ marginTop: '10px' }}>
                                        <div>
                                            <strong>{TEAMS_DATA[selectedMatch.team1].short}:</strong> {getTeamCount(selectedMatch.team1)}/7 |
                                            <strong> {TEAMS_DATA[selectedMatch.team2].short}:</strong> {getTeamCount(selectedMatch.team2)}/7
                                        </div>
                                        <div>
                                            {captain && <span style={{ color: '#10b981', marginRight: '10px' }}> Captain</span>}
                                            {viceCaptain && <span style={{ color: '#3b82f6' }}> VC</span>}
                                        </div>
                                    </div>

                                    {validationErrors.length > 0 && (
                                        <div className="validation-error">
                                            <strong> Please fix these issues:</strong>
                                            <ul>
                                                {validationErrors.map((error, i) => (
                                                    <li key={i}>{error}</li>
                                                ))}
                                            </ul>
                                        </div>
                                    )}

                                    <input
                                        type="text"
                                        className="search-box"
                                        placeholder="Search players..."
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                    />

                                    <div className="role-tabs">
                                        {['ALL', 'WK', 'BAT', 'AR', 'BOWL'].map(role => (
                                            <div
                                                key={role}
                                                className={`role-tab ${activeRole === role ? 'active' : ''}`}
                                                onClick={() => setActiveRole(role)}
                                            >
                                                {role}
                                            </div>
                                        ))}
                                    </div>

                                    <div className="players-grid">
                                        {filteredPlayers.map(player => {
                                            const isSelected = selectedPlayers.find(p => p.id === player.id);
                                            const isCaptain = captain === player.id;
                                            const isVC = viceCaptain === player.id;
                                            const canSelect = selectedPlayers.length < 11 || isSelected;
                                            
                                            return (
                                                <div
                                                    key={player.id}
                                                    className={`player-card ${isSelected ? 'selected' : ''} ${!canSelect ? 'disabled' : ''}`}
                                                    onClick={() => canSelect && togglePlayer(player)}
                                                >
                                                    <div className="player-name">{player.name}</div>
                                                    <div className="player-team">{TEAMS_DATA[player.team].name}</div>
                                                    <div className="player-meta">
                                                        <span className="player-role">{player.role}</span>
                                                        <span className="player-credits">{player.credits} Cr</span>
                                                    </div>
                                                    
                                                    {isSelected && (
                                                        <div className="captain-buttons" onClick={(e) => e.stopPropagation()}>
                                                            <button
                                                                className={`captain-btn ${isCaptain ? 'active-captain' : ''}`}
                                                                onClick={() => setCaptain(player.id)}
                                                            >
                                                                {isCaptain ? ' C (2x)' : 'Captain'}
                                                            </button>
                                                            <button
                                                                className={`captain-btn ${isVC ? 'active-vc' : ''}`}
                                                                onClick={() => setViceCaptain(player.id)}
                                                            >
                                                                {isVC ? ' VC (1.5x)' : 'VC'}
                                                            </button>
                                                        </div>
                                                    )}
                                                </div>
                                            );
                                        })}
                                    </div>

                                    <button
                                        className="btn"
                                        onClick={saveTeam}
                                        style={{ marginTop: '30px' }}
                                    >
                                        {myTeams[selectedMatch.id] ? 'Update Team' : 'Save Team'}
                                    </button>
                                </div>
                            )}
                        </div>
                    )}

                    {activeTab === 'myTeams' && (
                        <div className="card">
                            <h2>My Teams</h2>
                            {Object.keys(myTeams).length === 0 ? (
                                <p style={{ textAlign: 'center', padding: '40px', color: '#8892b0' }}>
                                    No teams created yet. Go to MATCHES tab to create teams.
                                </p>
                            ) : (
                                <div className="my-teams-list">
                                    {Object.values(myTeams).map(team => (
                                        <div key={team.id} className="team-item">
                                            <h4>{team.matchName}</h4>
                                            <p style={{ color: '#8892b0', marginBottom: '15px' }}>
                                                 {team.matchDate} | Credits: {team.totalCredits.toFixed(1)}
                                            </p>
                                            <div className="team-players">
                                                {team.players.map(p => (
                                                    <div key={p.id} className="team-player-name">
                                                        {p.name}
                                                        {p.id === team.captain && ' '}
                                                        {p.id === team.viceCaptain && ' '}
                                                        <span style={{ float: 'right', color: '#10b981' }}>
                                                            {p.credits} Cr
                                                        </span>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        }

        // ===== LOGIN COMPONENT =====
        function LoginForm({ setUser }) {
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);

            const handleLogin = async (e) => {
                e.preventDefault();
                setError('');
                setLoading(true);

                try {
                    // Try to authenticate with Firebase Auth first
                    try {
                        const userCredential = await auth.signInWithEmailAndPassword(email, password);
                        return;
                    } catch (authError) {
                        // If auth fails, check Firestore
                        console.log('Checking Firestore for user...');
                    }

                    // Check Firestore users collection
                    const usersSnapshot = await db.collection('users')
                        .where('username', '==', email.split('@')[0])
                        .get();

                    if (usersSnapshot.empty) {
                        const emailSnapshot = await db.collection('users')
                            .where('email', '==', email)
                            .get();
                        
                        if (emailSnapshot.empty) {
                            setError('User not found. Please check your credentials.');
                            setLoading(false);
                            return;
                        }
                    }

                    // User exists in Firestore, create Firebase Auth account
                    try {
                        const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                        
                        // Update display name if available
                        const userData = usersSnapshot.docs[0]?.data() || emailSnapshot.docs[0]?.data();
                        if (userData && userData.name) {
                            await userCredential.user.updateProfile({
                                displayName: userData.name
                            });
                        }
                    } catch (createError) {
                        if (createError.code === 'auth/email-already-in-use') {
                            // Try to sign in again
                            await auth.signInWithEmailAndPassword(email, password);
                        } else {
                            throw createError;
                        }
                    }

                } catch (error) {
                    console.error('Login error:', error);
                    setError(error.message || 'Invalid credentials. Please try again.');
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="login-container">
                    <h2> Login to Fantasy Cricket</h2>
                    
                    {error && (
                        <div className="error-message">
                            {error}
                        </div>
                    )}

                    <form onSubmit={handleLogin}>
                        <div className="form-group">
                            <label>Email / Username</label>
                            <input
                                type="text"
                                value={email}
                                onChange={(e) => setEmail(e.target.value)}
                                placeholder="Enter your email or username"
                                required
                            />
                        </div>

                        <div className="form-group">
                            <label>Password</label>
                            <input
                                type="password"
                                value={password}
                                onChange={(e) => setPassword(e.target.value)}
                                placeholder="Enter your password"
                                required
                            />
                        </div>

                        <button type="submit" className="btn" disabled={loading}>
                            {loading ? 'Logging in...' : 'Login'}
                        </button>
                    </form>

                    <p style={{ marginTop: '20px', textAlign: 'center', color: '#8892b0', fontSize: '0.9rem' }}>
                        Use your Firestore credentials to login
                    </p>
                </div>
            );
        }

        // Render app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
