<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fantasy Cricket - Women's T20 World Cup 2026</title>
    
    <!-- React -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Firebase v9 -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, query, where, getDocs, doc, setDoc, getDoc, addDoc, updateDoc, deleteDoc, orderBy, onSnapshot, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDacks7Qnk42D2898leU_kgG8DZsYTFxCw",
            authDomain: "t20-fantasy-contest.firebaseapp.com",
            projectId: "t20-fantasy-contest",
            storageBucket: "t20-fantasy-contest.firebasestorage.app",
            messagingSenderId: "180217303236",
            appId: "1:180217303236:web:a6b078a7a7d0fa070c3991",
            measurementId: "G-LYY944KN99"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.firebaseModules = {
            collection, query, where, getDocs, doc, setDoc, getDoc, addDoc, 
            updateDoc, deleteDoc, orderBy, onSnapshot, serverTimestamp,
            signInWithEmailAndPassword, createUserWithEmailAndPassword,
            signOut, onAuthStateChanged
        };
        window.firebaseReady = true;
        
        console.log("‚úÖ Firebase initialized");
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #1a202c;
        }

        #root {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 25px 30px;
            border-radius: 16px;
            margin-bottom: 24px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }

        .header-right {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 16px;
            background: #f7fafc;
            border-radius: 10px;
        }

        .admin-badge {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.95rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn-danger {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #a8e063 0%, #56ab2f 100%);
        }

        .tabs {
            display: flex;
            gap: 10px;
            background: white;
            padding: 8px;
            border-radius: 12px;
            margin-bottom: 24px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .tab {
            flex: 1;
            padding: 14px;
            background: transparent;
            border: none;
            color: #718096;
            font-weight: 600;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.95rem;
        }
        
        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .card {
            background: white;
            padding: 28px;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            margin-bottom: 24px;
        }

        .card h2 {
            font-family: 'Poppins', sans-serif;
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #2d3748;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
            font-family: 'Inter', sans-serif;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .contest-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            margin-top: 24px;
        }

        .contest-card {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border: 2px solid #e2e8f0;
            border-radius: 14px;
            padding: 20px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .contest-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.12);
            border-color: #667eea;
        }

        .contest-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .contest-title {
            font-weight: 700;
            font-size: 1.1rem;
            color: #2d3748;
        }

        .contest-prize {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            padding: 6px 14px;
            border-radius: 8px;
            font-weight: 700;
            color: #744210;
            font-size: 0.9rem;
        }

        .contest-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 16px;
        }

        .info-item {
            background: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .info-label {
            font-size: 0.75rem;
            color: #718096;
            margin-bottom: 4px;
        }

        .info-value {
            font-weight: 700;
            color: #2d3748;
            font-size: 1rem;
        }

        .match-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 14px;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.3s;
        }

        .match-card:hover {
            border-color: #667eea;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .match-teams {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .team {
            flex: 1;
            text-align: center;
        }

        .team-name {
            font-weight: 700;
            font-size: 1.1rem;
            color: #2d3748;
        }

        .team-flag {
            font-size: 2.5rem;
            margin-bottom: 8px;
        }

        .vs {
            font-weight: 800;
            color: #cbd5e0;
            font-size: 1.2rem;
            padding: 0 20px;
        }

        .match-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 16px;
            border-top: 2px solid #f7fafc;
        }

        .match-date {
            font-size: 0.85rem;
            color: #718096;
        }

        .match-venue {
            font-size: 0.85rem;
            color: #718096;
            font-weight: 500;
        }

        .player-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 20px;
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            color: #4a5568;
        }

        .filter-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .players-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .player-card {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 16px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .player-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .player-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #eef2ff 0%, #e0e7ff 100%);
        }

        .player-card.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .player-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .player-name {
            font-weight: 700;
            font-size: 1rem;
            color: #2d3748;
        }

        .player-credits {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 4px 10px;
            border-radius: 6px;
            font-weight: 700;
            font-size: 0.85rem;
        }

        .player-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .player-role {
            font-size: 0.85rem;
            color: #718096;
            font-weight: 600;
        }

        .player-team {
            font-size: 0.85rem;
            color: #a0aec0;
        }

        .team-summary {
            position: sticky;
            top: 20px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 14px;
            padding: 20px;
        }

        .summary-header {
            margin-bottom: 20px;
        }

        .summary-title {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 12px;
            color: #2d3748;
        }

        .credits-bar {
            background: #f7fafc;
            height: 12px;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .credits-fill {
            height: 100%;
            background: linear-gradient(90deg, #56ab2f 0%, #a8e063 100%);
            transition: all 0.3s;
        }

        .credits-fill.warning {
            background: linear-gradient(90deg, #f093fb 0%, #f5576c 100%);
        }

        .credits-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: #718096;
        }

        .role-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .role-stat {
            background: #f7fafc;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }

        .role-label {
            font-size: 0.75rem;
            color: #718096;
            margin-bottom: 4px;
        }

        .role-count {
            font-weight: 700;
            font-size: 1.1rem;
            color: #2d3748;
        }

        .role-count.warning {
            color: #f5576c;
        }

        .role-count.success {
            color: #56ab2f;
        }

        .selected-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 16px;
        }

        .selected-player {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f7fafc;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .captain-selector {
            background: #fff5f5;
            border: 2px solid #fed7d7;
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .captain-label {
            font-weight: 600;
            margin-bottom: 10px;
            color: #742a2a;
        }

        .captain-options {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .captain-btn {
            padding: 8px 14px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
        }

        .captain-btn.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .alert {
            padding: 14px 18px;
            border-radius: 10px;
            margin-bottom: 16px;
            font-size: 0.9rem;
        }

        .alert-success {
            background: #f0fdf4;
            border: 2px solid #86efac;
            color: #166534;
        }

        .alert-warning {
            background: #fffbeb;
            border: 2px solid #fde68a;
            color: #92400e;
        }

        .alert-error {
            background: #fef2f2;
            border: 2px solid #fecaca;
            color: #991b1b;
        }

        .alert-info {
            background: #eff6ff;
            border: 2px solid #bfdbfe;
            color: #1e40af;
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #94a3b8;
        }

        .loading::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        .auth-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .auth-card {
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 440px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }

        .auth-title {
            font-family: 'Poppins', sans-serif;
            font-size: 2rem;
            font-weight: 800;
            text-align: center;
            margin-bottom: 32px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .auth-toggle {
            text-align: center;
            margin-top: 24px;
            color: #718096;
        }

        .auth-toggle a {
            color: #667eea;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
        }

        .auth-toggle a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 16px;
                text-align: center;
            }

            .header h1 {
                font-size: 1.5rem;
            }

            .tabs {
                flex-direction: column;
            }

            .contest-grid,
            .players-grid {
                grid-template-columns: 1fr;
            }

            .match-teams {
                flex-direction: column;
                gap: 20px;
            }

            .vs {
                transform: rotate(90deg);
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Women's T20 World Cup 2026 Fixtures
        const WT20_MATCHES = [
            { id: 'm1', team1: 'IND', team2: 'NZ', date: '2026-10-03', time: '14:00', venue: 'Dubai', group: 'A' },
            { id: 'm2', team1: 'PAK', team2: 'SL', date: '2026-10-03', time: '18:30', venue: 'Sharjah', group: 'A' },
            { id: 'm3', team1: 'IND', team2: 'PAK', date: '2026-10-06', time: '18:30', venue: 'Dubai', group: 'A' },
            { id: 'm4', team1: 'NZ', team2: 'SL', date: '2026-10-07', time: '14:00', venue: 'Sharjah', group: 'A' },
            { id: 'm5', team1: 'IND', team2: 'SL', date: '2026-10-09', time: '18:30', venue: 'Dubai', group: 'A' },
            { id: 'm6', team1: 'PAK', team2: 'NZ', date: '2026-10-10', time: '14:00', venue: 'Sharjah', group: 'A' },
            { id: 'm7', team1: 'AUS', team2: 'SA', date: '2026-10-05', time: '14:00', venue: 'Sharjah', group: 'B' },
            { id: 'm8', team1: 'ENG', team2: 'WI', date: '2026-10-05', time: '18:30', venue: 'Dubai', group: 'B' },
            { id: 'm9', team1: 'AUS', team2: 'ENG', date: '2026-10-08', time: '18:30', venue: 'Sharjah', group: 'B' },
            { id: 'm10', team1: 'SA', team2: 'WI', date: '2026-10-09', time: '14:00', venue: 'Dubai', group: 'B' },
            { id: 'm11', team1: 'AUS', team2: 'WI', date: '2026-10-12', time: '14:00', venue: 'Dubai', group: 'B' },
            { id: 'm12', team1: 'ENG', team2: 'SA', date: '2026-10-12', time: '18:30', venue: 'Sharjah', group: 'B' },
            { id: 'sf1', team1: 'A1', team2: 'B2', date: '2026-10-16', time: '18:30', venue: 'Dubai', group: 'SF' },
            { id: 'sf2', team1: 'B1', team2: 'A2', date: '2026-10-17', time: '18:30', venue: 'Sharjah', group: 'SF' },
            { id: 'final', team1: 'SF1W', team2: 'SF2W', date: '2026-10-20', time: '18:30', venue: 'Dubai', group: 'Final' }
        ];

        const TEAM_FLAGS = {
            'IND': 'üáÆüá≥', 'PAK': 'üáµüá∞', 'NZ': 'üá≥üáø', 'SL': 'üá±üá∞',
            'AUS': 'üá¶üá∫', 'ENG': 'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø', 'SA': 'üáøüá¶', 'WI': 'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø',
            'A1': 'üèÜ', 'B1': 'üèÜ', 'A2': 'ü•à', 'B2': 'ü•à', 'SF1W': 'üèÜ', 'SF2W': 'üèÜ'
        };

        const TEAM_NAMES = {
            'IND': 'India', 'PAK': 'Pakistan', 'NZ': 'New Zealand', 'SL': 'Sri Lanka',
            'AUS': 'Australia', 'ENG': 'England', 'SA': 'South Africa', 'WI': 'West Indies',
            'A1': 'Group A Winner', 'B1': 'Group B Winner', 'A2': 'Group A Runner-up', 'B2': 'Group B Runner-up',
            'SF1W': 'SF1 Winner', 'SF2W': 'SF2 Winner'
        };

        const PLAYERS_DATABASE = [
            // India
            { id: 'p1', name: 'Smriti Mandhana', team: 'IND', role: 'BAT', credits: 10.0 },
            { id: 'p2', name: 'Harmanpreet Kaur', team: 'IND', role: 'AR', credits: 9.5 },
            { id: 'p3', name: 'Richa Ghosh', team: 'IND', role: 'WK', credits: 8.5 },
            { id: 'p4', name: 'Jemimah Rodrigues', team: 'IND', role: 'BAT', credits: 8.5 },
            { id: 'p5', name: 'Deepti Sharma', team: 'IND', role: 'AR', credits: 9.0 },
            { id: 'p6', name: 'Renuka Thakur', team: 'IND', role: 'BOWL', credits: 8.5 },
            { id: 'p7', name: 'Radha Yadav', team: 'IND', role: 'BOWL', credits: 7.5 },
            { id: 'p8', name: 'Shafali Verma', team: 'IND', role: 'BAT', credits: 9.0 },
            { id: 'p9', name: 'Pooja Vastrakar', team: 'IND', role: 'AR', credits: 8.0 },
            { id: 'p10', name: 'Yastika Bhatia', team: 'IND', role: 'WK', credits: 7.5 },
            { id: 'p11', name: 'Rajeshwari Gayakwad', team: 'IND', role: 'BOWL', credits: 7.0 },
            // Australia
            { id: 'p12', name: 'Alyssa Healy', team: 'AUS', role: 'WK', credits: 10.0 },
            { id: 'p13', name: 'Meg Lanning', team: 'AUS', role: 'BAT', credits: 10.0 },
            { id: 'p14', name: 'Ellyse Perry', team: 'AUS', role: 'AR', credits: 10.0 },
            { id: 'p15', name: 'Beth Mooney', team: 'AUS', role: 'WK', credits: 9.0 },
            { id: 'p16', name: 'Ashleigh Gardner', team: 'AUS', role: 'AR', credits: 9.0 },
            { id: 'p17', name: 'Megan Schutt', team: 'AUS', role: 'BOWL', credits: 9.0 },
            { id: 'p18', name: 'Annabel Sutherland', team: 'AUS', role: 'AR', credits: 8.5 },
            { id: 'p19', name: 'Tahlia McGrath', team: 'AUS', role: 'AR', credits: 8.5 },
            { id: 'p20', name: 'Darcie Brown', team: 'AUS', role: 'BOWL', credits: 7.5 },
            { id: 'p21', name: 'Jess Jonassen', team: 'AUS', role: 'BOWL', credits: 8.0 },
            { id: 'p22', name: 'Georgia Wareham', team: 'AUS', role: 'BOWL', credits: 8.0 },
            // England
            { id: 'p23', name: 'Heather Knight', team: 'ENG', role: 'AR', credits: 9.0 },
            { id: 'p24', name: 'Nat Sciver-Brunt', team: 'ENG', role: 'AR', credits: 9.5 },
            { id: 'p25', name: 'Danni Wyatt', team: 'ENG', role: 'BAT', credits: 8.5 },
            { id: 'p26', name: 'Amy Jones', team: 'ENG', role: 'WK', credits: 8.5 },
            { id: 'p27', name: 'Sophie Ecclestone', team: 'ENG', role: 'BOWL', credits: 9.5 },
            { id: 'p28', name: 'Katherine Sciver-Brunt', team: 'ENG', role: 'BOWL', credits: 8.5 },
            { id: 'p29', name: 'Alice Capsey', team: 'ENG', role: 'AR', credits: 8.0 },
            { id: 'p30', name: 'Lauren Bell', team: 'ENG', role: 'BOWL', credits: 7.5 },
            { id: 'p31', name: 'Sarah Glenn', team: 'ENG', role: 'BOWL', credits: 8.0 },
            { id: 'p32', name: 'Freya Kemp', team: 'ENG', role: 'AR', credits: 7.5 },
            { id: 'p33', name: 'Tammy Beaumont', team: 'ENG', role: 'BAT', credits: 8.0 },
            // New Zealand
            { id: 'p34', name: 'Sophie Devine', team: 'NZ', role: 'AR', credits: 9.5 },
            { id: 'p35', name: 'Suzie Bates', team: 'NZ', role: 'BAT', credits: 9.0 },
            { id: 'p36', name: 'Amelia Kerr', team: 'NZ', role: 'AR', credits: 9.0 },
            { id: 'p37', name: 'Lea Tahuhu', team: 'NZ', role: 'BOWL', credits: 8.0 },
            { id: 'p38', name: 'Maddy Green', team: 'NZ', role: 'AR', credits: 8.0 },
            { id: 'p39', name: 'Isabella Gaze', team: 'NZ', role: 'WK', credits: 7.5 },
            { id: 'p40', name: 'Rosemary Mair', team: 'NZ', role: 'BOWL', credits: 7.5 },
            { id: 'p41', name: 'Brooke Halliday', team: 'NZ', role: 'BAT', credits: 7.5 },
            { id: 'p42', name: 'Eden Carson', team: 'NZ', role: 'BOWL', credits: 7.0 },
            { id: 'p43', name: 'Jess Kerr', team: 'NZ', role: 'BOWL', credits: 7.5 },
            // South Africa
            { id: 'p44', name: 'Laura Wolvaardt', team: 'SA', role: 'BAT', credits: 9.5 },
            { id: 'p45', name: 'Marizanne Kapp', team: 'SA', role: 'AR', credits: 9.5 },
            { id: 'p46', name: 'Chloe Tryon', team: 'SA', role: 'AR', credits: 8.5 },
            { id: 'p47', name: 'Nadine de Klerk', team: 'SA', role: 'AR', credits: 8.0 },
            { id: 'p48', name: 'Shabnim Ismail', team: 'SA', role: 'BOWL', credits: 9.0 },
            { id: 'p49', name: 'Ayabonga Khaka', team: 'SA', role: 'BOWL', credits: 8.0 },
            { id: 'p50', name: 'Sinalo Jafta', team: 'SA', role: 'WK', credits: 7.5 },
            { id: 'p51', name: 'Annerie Dercksen', team: 'SA', role: 'AR', credits: 7.5 },
            { id: 'p52', name: 'Nonkululeko Mlaba', team: 'SA', role: 'BOWL', credits: 8.0 },
            { id: 'p53', name: 'Tazmin Brits', team: 'SA', role: 'BAT', credits: 8.0 },
            // West Indies
            { id: 'p54', name: 'Hayley Matthews', team: 'WI', role: 'AR', credits: 9.5 },
            { id: 'p55', name: 'Deandra Dottin', team: 'WI', role: 'AR', credits: 9.0 },
            { id: 'p56', name: 'Stafanie Taylor', team: 'WI', role: 'AR', credits: 9.0 },
            { id: 'p57', name: 'Shemaine Campbelle', team: 'WI', role: 'WK', credits: 8.0 },
            { id: 'p58', name: 'Shamilia Connell', team: 'WI', role: 'BOWL', credits: 8.0 },
            { id: 'p59', name: 'Afy Fletcher', team: 'WI', role: 'BOWL', credits: 7.5 },
            { id: 'p60', name: 'Aaliyah Alleyne', team: 'WI', role: 'AR', credits: 7.5 },
            { id: 'p61', name: 'Chinelle Henry', team: 'WI', role: 'AR', credits: 7.5 },
            { id: 'p62', name: 'Karishma Ramharack', team: 'WI', role: 'BOWL', credits: 7.0 },
            { id: 'p63', name: 'Qiana Joseph', team: 'WI', role: 'BAT', credits: 7.5 },
            // Pakistan
            { id: 'p64', name: 'Nida Dar', team: 'PAK', role: 'AR', credits: 9.0 },
            { id: 'p65', name: 'Bismah Maroof', team: 'PAK', role: 'BAT', credits: 8.5 },
            { id: 'p66', name: 'Muneeba Ali', team: 'PAK', role: 'WK', credits: 8.0 },
            { id: 'p67', name: 'Diana Baig', team: 'PAK', role: 'BOWL', credits: 7.5 },
            { id: 'p68', name: 'Sadia Iqbal', team: 'PAK', role: 'BOWL', credits: 7.5 },
            { id: 'p69', name: 'Aliya Riaz', team: 'PAK', role: 'AR', credits: 7.5 },
            { id: 'p70', name: 'Fatima Sana', team: 'PAK', role: 'AR', credits: 8.0 },
            { id: 'p71', name: 'Sidra Amin', team: 'PAK', role: 'BAT', credits: 7.5 },
            { id: 'p72', name: 'Nashra Sandhu', team: 'PAK', role: 'BOWL', credits: 7.0 },
            { id: 'p73', name: 'Omaima Sohail', team: 'PAK', role: 'AR', credits: 7.5 },
            // Sri Lanka
            { id: 'p74', name: 'Chamari Athapaththu', team: 'SL', role: 'AR', credits: 9.5 },
            { id: 'p75', name: 'Harshitha Samarawickrama', team: 'SL', role: 'BAT', credits: 8.0 },
            { id: 'p76', name: 'Anushka Sanjeewani', team: 'SL', role: 'WK', credits: 7.5 },
            { id: 'p77', name: 'Oshadi Ranasinghe', team: 'SL', role: 'BOWL', credits: 7.5 },
            { id: 'p78', name: 'Inoka Ranaweera', team: 'SL', role: 'BOWL', credits: 7.5 },
            { id: 'p79', name: 'Kavisha Dilhari', team: 'SL', role: 'AR', credits: 7.5 },
            { id: 'p80', name: 'Udeshika Prabodhani', team: 'SL', role: 'BOWL', credits: 7.0 },
            { id: 'p81', name: 'Vishmi Gunaratne', team: 'SL', role: 'BAT', credits: 7.5 },
            { id: 'p82', name: 'Sugandika Kumari', team: 'SL', role: 'BOWL', credits: 7.5 },
            { id: 'p83', name: 'Nilakshi de Silva', team: 'SL', role: 'AR', credits: 7.0 }
        ];

        const DREAM11_RULES = {
            totalPlayers: 11,
            maxCredits: 100,
            minWK: 1, maxWK: 4,
            minBAT: 3, maxBAT: 6,
            minAR: 1, maxAR: 4,
            minBOWL: 3, maxBOWL: 6,
            maxFromOneTeam: 7,
            captainPoints: 2,
            viceCaptainPoints: 1.5
        };

        function App() {
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                const checkAuth = () => {
                    const { onAuthStateChanged } = window.firebaseModules;
                    onAuthStateChanged(window.firebaseAuth, (currentUser) => {
                        setUser(currentUser);
                        setLoading(false);
                    });
                };

                if (window.firebaseReady) {
                    checkAuth();
                } else {
                    const interval = setInterval(() => {
                        if (window.firebaseReady) {
                            checkAuth();
                            clearInterval(interval);
                        }
                    }, 100);
                }
            }, []);

            if (loading) {
                return (
                    <div className="auth-container">
                        <div className="loading">Loading Fantasy Cricket</div>
                    </div>
                );
            }

            if (!user) {
                return <AuthScreen onAuth={setUser} />;
            }

            return <Dashboard user={user} />;
        }

        function AuthScreen({ onAuth }) {
            const [isLogin, setIsLogin] = useState(true);
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [username, setUsername] = useState('');
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);

            const handleSubmit = async (e) => {
                e.preventDefault();
                setError('');
                setLoading(true);

                try {
                    const { signInWithEmailAndPassword, createUserWithEmailAndPassword, setDoc, doc } = window.firebaseModules;

                    if (isLogin) {
                        await signInWithEmailAndPassword(window.firebaseAuth, email, password);
                    } else {
                        const userCred = await createUserWithEmailAndPassword(window.firebaseAuth, email, password);
                        await setDoc(doc(window.firebaseDb, 'users', userCred.user.uid), {
                            username: username || email.split('@')[0],
                            email,
                            isAdmin: false,
                            createdAt: new Date().toISOString()
                        });
                    }
                } catch (err) {
                    setError(err.message);
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="auth-container">
                    <div className="auth-card">
                        <h1 className="auth-title">Fantasy Cricket</h1>
                        <p style={{ textAlign: 'center', color: '#718096', marginBottom: '24px' }}>
                            Women's T20 World Cup 2026
                        </p>

                        {error && <div className="alert alert-error">{error}</div>}

                        <form onSubmit={handleSubmit}>
                            {!isLogin && (
                                <div className="form-group">
                                    <label>Username</label>
                                    <input type="text" value={username} onChange={(e) => setUsername(e.target.value)} placeholder="Enter username" required />
                                </div>
                            )}

                            <div className="form-group">
                                <label>Email</label>
                                <input type="email" value={email} onChange={(e) => setEmail(e.target.value)} placeholder="Enter email" required />
                            </div>

                            <div className="form-group">
                                <label>Password</label>
                                <input type="password" value={password} onChange={(e) => setPassword(e.target.value)} placeholder="Enter password" required />
                            </div>

                            <button type="submit" className="btn" style={{ width: '100%' }} disabled={loading}>
                                {loading ? 'Please wait...' : (isLogin ? 'Login' : 'Sign Up')}
                            </button>
                        </form>

                        <div className="auth-toggle">
                            {isLogin ? "Don't have an account? " : "Already have an account? "}
                            <a onClick={() => setIsLogin(!isLogin)}>
                                {isLogin ? 'Sign Up' : 'Login'}
                            </a>
                        </div>
                    </div>
                </div>
            );
        }

        function Dashboard({ user }) {
            const [activeTab, setActiveTab] = useState('contests');
            const [isAdmin, setIsAdmin] = useState(false);
            const [username, setUsername] = useState('');

            useEffect(() => {
                loadUserData();
            }, [user]);

            const loadUserData = async () => {
                try {
                    const { doc, getDoc } = window.firebaseModules;
                    const userDoc = await getDoc(doc(window.firebaseDb, 'users', user.uid));
                    if (userDoc.exists()) {
                        const userData = userDoc.data();
                        setIsAdmin(userData.isAdmin || false);
                        setUsername(userData.username || user.email.split('@')[0]);
                    }
                } catch (error) {
                    console.error('Error loading user data:', error);
                }
            };

            const handleLogout = async () => {
                const { signOut } = window.firebaseModules;
                await signOut(window.firebaseAuth);
            };

            return (
                <>
                    <div className="header">
                        <h1>‚ö° Fantasy Cricket</h1>
                        <div className="header-right">
                            <div className="user-info">
                                <span>{username}</span>
                                {isAdmin && <span className="admin-badge">Admin</span>}
                            </div>
                            <button className="btn btn-secondary" onClick={handleLogout}>Logout</button>
                        </div>
                    </div>

                    <div className="tabs">
                        <button className={`tab ${activeTab === 'contests' ? 'active' : ''}`} onClick={() => setActiveTab('contests')}>
                            üèÜ Contests
                        </button>
                        <button className={`tab ${activeTab === 'matches' ? 'active' : ''}`} onClick={() => setActiveTab('matches')}>
                            üèè Matches
                        </button>
                        <button className={`tab ${activeTab === 'teams' ? 'active' : ''}`} onClick={() => setActiveTab('teams')}>
                            üë• My Teams
                        </button>
                        <button className={`tab ${activeTab === 'leaderboard' ? 'active' : ''}`} onClick={() => setActiveTab('leaderboard')}>
                            üìä Leaderboard
                        </button>
                        {isAdmin && (
                            <button className={`tab ${activeTab === 'admin' ? 'active' : ''}`} onClick={() => setActiveTab('admin')}>
                                ‚öôÔ∏è Admin
                            </button>
                        )}
                    </div>

                    {activeTab === 'contests' && <Contests user={user} />}
                    {activeTab === 'matches' && <Matches user={user} />}
                    {activeTab === 'teams' && <MyTeams user={user} />}
                    {activeTab === 'leaderboard' && <Leaderboard />}
                    {activeTab === 'admin' && isAdmin && <AdminPanel />}
                </>
            );
        }

        function AdminPanel() {
            const [contestName, setContestName] = useState('');
            const [prizePool, setPrizePool] = useState('');
            const [entryFee, setEntryFee] = useState('');
            const [totalSpots, setTotalSpots] = useState('');
            const [contests, setContests] = useState([]);
            const [loading, setLoading] = useState(false);

            useEffect(() => {
                loadContests();
            }, []);

            const loadContests = async () => {
                try {
                    const { collection, getDocs } = window.firebaseModules;
                    const snapshot = await getDocs(collection(window.firebaseDb, 'contests'));
                    const contestsList = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    setContests(contestsList);
                } catch (error) {
                    console.error('Error loading contests:', error);
                }
            };

            const createContest = async (e) => {
                e.preventDefault();
                setLoading(true);

                try {
                    const { addDoc, collection, serverTimestamp } = window.firebaseModules;
                    
                    await addDoc(collection(window.firebaseDb, 'contests'), {
                        name: contestName,
                        prizePool: parseFloat(prizePool),
                        entryFee: parseFloat(entryFee),
                        totalSpots: parseInt(totalSpots),
                        filledSpots: 0,
                        matches: WT20_MATCHES.map(m => m.id),
                        createdAt: serverTimestamp(),
                        status: 'active'
                    });

                    alert('‚úÖ Contest created! All WT20 matches are available.');
                    setContestName('');
                    setPrizePool('');
                    setEntryFee('');
                    setTotalSpots('');
                    loadContests();
                } catch (error) {
                    alert('‚ùå Error creating contest');
                } finally {
                    setLoading(false);
                }
            };

            const deleteContest = async (contestId) => {
                if (!confirm('Delete this contest?')) return;
                try {
                    const { doc, deleteDoc } = window.firebaseModules;
                    await deleteDoc(doc(window.firebaseDb, 'contests', contestId));
                    alert('‚úÖ Contest deleted');
                    loadContests();
                } catch (error) {
                    alert('‚ùå Error deleting contest');
                }
            };

            return (
                <div className="card">
                    <h2>‚öôÔ∏è Admin Panel - Contest Management</h2>

                    <div className="alert alert-info" style={{ marginBottom: '24px' }}>
                        <strong>‚ÑπÔ∏è How it works:</strong> Create a contest and all WT20 2026 matches will be automatically added. Users can create teams for any match in the contest.
                    </div>

                    <form onSubmit={createContest} style={{ marginBottom: '32px' }}>
                        <div className="form-group">
                            <label>Contest Name</label>
                            <input type="text" value={contestName} onChange={(e) => setContestName(e.target.value)} placeholder="e.g., Mega Contest" required />
                        </div>

                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '16px' }}>
                            <div className="form-group">
                                <label>Prize Pool (‚Çπ)</label>
                                <input type="number" value={prizePool} onChange={(e) => setPrizePool(e.target.value)} placeholder="10000" required />
                            </div>
                            <div className="form-group">
                                <label>Entry Fee (‚Çπ)</label>
                                <input type="number" value={entryFee} onChange={(e) => setEntryFee(e.target.value)} placeholder="50" required />
                            </div>
                            <div className="form-group">
                                <label>Total Spots</label>
                                <input type="number" value={totalSpots} onChange={(e) => setTotalSpots(e.target.value)} placeholder="1000" required />
                            </div>
                        </div>

                        <button type="submit" className="btn btn-success" disabled={loading}>
                            {loading ? 'Creating...' : '‚ûï Create Contest'}
                        </button>
                    </form>

                    <h3 style={{ marginBottom: '16px', color: '#4a5568' }}>Active Contests ({contests.length})</h3>
                    
                    {contests.length === 0 ? (
                        <p style={{ textAlign: 'center', color: '#94a3b8', padding: '40px' }}>No contests created yet</p>
                    ) : (
                        <div className="contest-grid">
                            {contests.map(contest => (
                                <div key={contest.id} className="contest-card">
                                    <div className="contest-header">
                                        <div className="contest-title">{contest.name}</div>
                                        <div className="contest-prize">‚Çπ{contest.prizePool.toLocaleString()}</div>
                                    </div>
                                    <div className="contest-info">
                                        <div className="info-item">
                                            <div className="info-label">Entry Fee</div>
                                            <div className="info-value">‚Çπ{contest.entryFee}</div>
                                        </div>
                                        <div className="info-item">
                                            <div className="info-label">Spots</div>
                                            <div className="info-value">{contest.filledSpots}/{contest.totalSpots}</div>
                                        </div>
                                        <div className="info-item">
                                            <div className="info-label">Matches</div>
                                            <div className="info-value">{contest.matches?.length || 0}</div>
                                        </div>
                                        <div className="info-item">
                                            <div className="info-label">Status</div>
                                            <div className="info-value" style={{ color: '#56ab2f' }}>{contest.status}</div>
                                        </div>
                                    </div>
                                    <button className="btn btn-danger" style={{ width: '100%', marginTop: '12px' }} onClick={() => deleteContest(contest.id)}>
                                        üóëÔ∏è Delete
                                    </button>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        }

        function Contests({ user }) {
            const [contests, setContests] = useState([]);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                loadContests();
            }, []);

            const loadContests = async () => {
                try {
                    const { collection, getDocs, query, where } = window.firebaseModules;
                    const q = query(collection(window.firebaseDb, 'contests'), where('status', '==', 'active'));
                    const snapshot = await getDocs(q);
                    const contestsList = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    setContests(contestsList);
                } catch (error) {
                    console.error('Error loading contests:', error);
                } finally {
                    setLoading(false);
                }
            };

            if (loading) {
                return <div className="card"><div className="loading">Loading contests</div></div>;
            }

            return (
                <div className="card">
                    <h2>üèÜ Available Contests</h2>
                    
                    {contests.length === 0 ? (
                        <div className="alert alert-info">No active contests available. Check back soon!</div>
                    ) : (
                        <div className="contest-grid">
                            {contests.map(contest => (
                                <div key={contest.id} className="contest-card">
                                    <div className="contest-header">
                                        <div className="contest-title">{contest.name}</div>
                                        <div className="contest-prize">‚Çπ{contest.prizePool.toLocaleString()}</div>
                                    </div>
                                    <p style={{ color: '#718096', fontSize: '0.9rem', marginBottom: '16px' }}>
                                        Create teams for all {contest.matches?.length || 0} Women's T20 World Cup matches
                                    </p>
                                    <div className="contest-info">
                                        <div className="info-item">
                                            <div className="info-label">Entry Fee</div>
                                            <div className="info-value">‚Çπ{contest.entryFee}</div>
                                        </div>
                                        <div className="info-item">
                                            <div className="info-label">Spots Left</div>
                                            <div className="info-value">{contest.totalSpots - contest.filledSpots}/{contest.totalSpots}</div>
                                        </div>
                                    </div>
                                    <div style={{ background: '#f7fafc', padding: '12px', borderRadius: '8px', marginTop: '12px', fontSize: '0.85rem', color: '#4a5568' }}>
                                        <strong>‚ú® Contest Features:</strong>
                                        <ul style={{ marginLeft: '20px', marginTop: '8px' }}>
                                            <li>All WT20 2026 matches</li>
                                            <li>Unlimited teams</li>
                                            <li>Win prizes for top performance</li>
                                        </ul>
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        }

        function Matches({ user }) {
            const [selectedMatch, setSelectedMatch] = useState(null);
            const [groupFilter, setGroupFilter] = useState('all');

            const filteredMatches = groupFilter === 'all' ? WT20_MATCHES : WT20_MATCHES.filter(m => m.group === groupFilter);

            if (selectedMatch) {
                return <TeamBuilder match={selectedMatch} user={user} onBack={() => setSelectedMatch(null)} />;
            }

            return (
                <div className="card">
                    <h2>üèè Women's T20 World Cup 2026</h2>

                    <div className="player-filters">
                        <button className={`filter-btn ${groupFilter === 'all' ? 'active' : ''}`} onClick={() => setGroupFilter('all')}>All Matches</button>
                        <button className={`filter-btn ${groupFilter === 'A' ? 'active' : ''}`} onClick={() => setGroupFilter('A')}>Group A</button>
                        <button className={`filter-btn ${groupFilter === 'B' ? 'active' : ''}`} onClick={() => setGroupFilter('B')}>Group B</button>
                        <button className={`filter-btn ${groupFilter === 'SF' ? 'active' : ''}`} onClick={() => setGroupFilter('SF')}>Semi Finals</button>
                        <button className={`filter-btn ${groupFilter === 'Final' ? 'active' : ''}`} onClick={() => setGroupFilter('Final')}>Final</button>
                    </div>

                    <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
                        {filteredMatches.map(match => (
                            <div key={match.id} className="match-card" onClick={() => setSelectedMatch(match)}>
                                <div style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', color: 'white', padding: '8px 16px', borderRadius: '8px', marginBottom: '16px', textAlign: 'center', fontWeight: '700', fontSize: '0.85rem' }}>
                                    {match.group === 'SF' ? 'Semi Final' : match.group === 'Final' ? 'FINAL' : `Group ${match.group}`}
                                </div>
                                <div className="match-teams">
                                    <div className="team">
                                        <div className="team-flag">{TEAM_FLAGS[match.team1]}</div>
                                        <div className="team-name">{TEAM_NAMES[match.team1]}</div>
                                    </div>
                                    <div className="vs">VS</div>
                                    <div className="team">
                                        <div className="team-flag">{TEAM_FLAGS[match.team2]}</div>
                                        <div className="team-name">{TEAM_NAMES[match.team2]}</div>
                                    </div>
                                </div>
                                <div className="match-info">
                                    <div className="match-date">üìÖ {new Date(match.date).toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })} ‚Ä¢ {match.time}</div>
                                    <div className="match-venue">üìç {match.venue}</div>
                                </div>
                                <button className="btn" style={{ width: '100%', marginTop: '16px' }}>Create Team</button>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        function TeamBuilder({ match, user, onBack }) {
            const [selectedPlayers, setSelectedPlayers] = useState([]);
            const [captain, setCaptain] = useState(null);
            const [viceCaptain, setViceCaptain] = useState(null);
            const [roleFilter, setRoleFilter] = useState('all');
            const [teamFilter, setTeamFilter] = useState('all');

            const matchPlayers = PLAYERS_DATABASE.filter(p => p.team === match.team1 || p.team === match.team2);
            const filteredPlayers = matchPlayers.filter(p => {
                if (roleFilter !== 'all' && p.role !== roleFilter) return false;
                if (teamFilter !== 'all' && p.team !== teamFilter) return false;
                return true;
            });

            const totalCredits = selectedPlayers.reduce((sum, p) => sum + p.credits, 0);
            const creditsRemaining = DREAM11_RULES.maxCredits - totalCredits;

            const roleCounts = {
                'WK': selectedPlayers.filter(p => p.role === 'WK').length,
                'BAT': selectedPlayers.filter(p => p.role === 'BAT').length,
                'AR': selectedPlayers.filter(p => p.role === 'AR').length,
                'BOWL': selectedPlayers.filter(p => p.role === 'BOWL').length
            };

            const teamCounts = {
                [match.team1]: selectedPlayers.filter(p => p.team === match.team1).length,
                [match.team2]: selectedPlayers.filter(p => p.team === match.team2).length
            };

            const handlePlayerClick = (player) => {
                const isSelected = selectedPlayers.find(p => p.id === player.id);

                if (isSelected) {
                    setSelectedPlayers(selectedPlayers.filter(p => p.id !== player.id));
                    if (captain === player.id) setCaptain(null);
                    if (viceCaptain === player.id) setViceCaptain(null);
                } else {
                    if (selectedPlayers.length >= DREAM11_RULES.totalPlayers) {
                        alert('‚ùå Maximum 11 players allowed');
                        return;
                    }
                    if (totalCredits + player.credits > DREAM11_RULES.maxCredits) {
                        alert('‚ùå Not enough credits');
                        return;
                    }

                    const newRoleCount = roleCounts[player.role] + 1;
                    const maxAllowed = player.role === 'WK' ? DREAM11_RULES.maxWK :
                                      player.role === 'BAT' ? DREAM11_RULES.maxBAT :
                                      player.role === 'AR' ? DREAM11_RULES.maxAR :
                                      DREAM11_RULES.maxBOWL;

                    if (newRoleCount > maxAllowed) {
                        alert(`‚ùå Maximum ${maxAllowed} ${player.role} allowed`);
                        return;
                    }

                    const newTeamCount = (teamCounts[player.team] || 0) + 1;
                    if (newTeamCount > DREAM11_RULES.maxFromOneTeam) {
                        alert(`‚ùå Maximum ${DREAM11_RULES.maxFromOneTeam} players from one team`);
                        return;
                    }

                    setSelectedPlayers([...selectedPlayers, player]);
                }
            };

            const canSaveTeam = 
                selectedPlayers.length === DREAM11_RULES.totalPlayers &&
                captain && viceCaptain &&
                roleCounts.WK >= DREAM11_RULES.minWK &&
                roleCounts.BAT >= DREAM11_RULES.minBAT &&
                roleCounts.AR >= DREAM11_RULES.minAR &&
                roleCounts.BOWL >= DREAM11_RULES.minBOWL;

            const saveTeam = async () => {
                if (!canSaveTeam) return;

                try {
                    const { addDoc, collection, serverTimestamp } = window.firebaseModules;
                    
                    await addDoc(collection(window.firebaseDb, 'teams'), {
                        userId: user.uid,
                        matchId: match.id,
                        matchName: `${TEAM_NAMES[match.team1]} vs ${TEAM_NAMES[match.team2]}`,
                        players: selectedPlayers,
                        captain,
                        viceCaptain,
                        totalCredits,
                        createdAt: serverTimestamp()
                    });

                    alert('‚úÖ Team saved successfully!');
                    onBack();
                } catch (error) {
                    alert('‚ùå Error saving team');
                }
            };

            return (
                <div className="card">
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '24px' }}>
                        <button className="btn btn-secondary" onClick={onBack}>‚Üê Back</button>
                        <h2 style={{ margin: 0 }}>{TEAM_NAMES[match.team1]} vs {TEAM_NAMES[match.team2]}</h2>
                        <div style={{ fontSize: '0.85rem', color: '#718096' }}>{match.date} ‚Ä¢ {match.venue}</div>
                    </div>

                    <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr', gap: '24px' }}>
                        <div>
                            <div className="alert alert-info">
                                <strong>üéØ Dream11 Rules:</strong> Select 11 players ‚Ä¢ Max 100 credits ‚Ä¢ WK: 1-4 ‚Ä¢ BAT: 3-6 ‚Ä¢ AR: 1-4 ‚Ä¢ BOWL: 3-6 ‚Ä¢ Max 7 from one team
                            </div>

                            <div className="player-filters">
                                <button className={`filter-btn ${roleFilter === 'all' ? 'active' : ''}`} onClick={() => setRoleFilter('all')}>All</button>
                                <button className={`filter-btn ${roleFilter === 'WK' ? 'active' : ''}`} onClick={() => setRoleFilter('WK')}>WK</button>
                                <button className={`filter-btn ${roleFilter === 'BAT' ? 'active' : ''}`} onClick={() => setRoleFilter('BAT')}>BAT</button>
                                <button className={`filter-btn ${roleFilter === 'AR' ? 'active' : ''}`} onClick={() => setRoleFilter('AR')}>AR</button>
                                <button className={`filter-btn ${roleFilter === 'BOWL' ? 'active' : ''}`} onClick={() => setRoleFilter('BOWL')}>BOWL</button>
                                <div style={{ borderLeft: '2px solid #e2e8f0', margin: '0 8px' }}></div>
                                <button className={`filter-btn ${teamFilter === 'all' ? 'active' : ''}`} onClick={() => setTeamFilter('all')}>Both Teams</button>
                                <button className={`filter-btn ${teamFilter === match.team1 ? 'active' : ''}`} onClick={() => setTeamFilter(match.team1)}>{TEAM_FLAGS[match.team1]} {match.team1}</button>
                                <button className={`filter-btn ${teamFilter === match.team2 ? 'active' : ''}`} onClick={() => setTeamFilter(match.team2)}>{TEAM_FLAGS[match.team2]} {match.team2}</button>
                            </div>

                            <div className="players-grid">
                                {filteredPlayers.map(player => {
                                    const isSelected = selectedPlayers.find(p => p.id === player.id);
                                    const canSelect = !isSelected && (selectedPlayers.length < DREAM11_RULES.totalPlayers && totalCredits + player.credits <= DREAM11_RULES.maxCredits);

                                    return (
                                        <div key={player.id} className={`player-card ${isSelected ? 'selected' : ''} ${!canSelect && !isSelected ? 'disabled' : ''}`} onClick={() => handlePlayerClick(player)}>
                                            <div className="player-header">
                                                <div>
                                                    <div className="player-name">{player.name}</div>
                                                    <div className="player-team">{TEAM_FLAGS[player.team]} {TEAM_NAMES[player.team]}</div>
                                                </div>
                                                <div className="player-credits">{player.credits}</div>
                                            </div>
                                            <div className="player-info">
                                                <span className="player-role">{player.role}</span>
                                                {isSelected && <span style={{ color: '#56ab2f', fontWeight: '700' }}>‚úì Selected</span>}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>

                        <div>
                            <div className="team-summary">
                                <div className="summary-header">
                                    <div className="summary-title">Team Summary ({selectedPlayers.length}/11)</div>
                                    <div className="credits-bar">
                                        <div className={`credits-fill ${creditsRemaining < 0 ? 'warning' : ''}`} style={{ width: `${(totalCredits / DREAM11_RULES.maxCredits) * 100}%` }}></div>
                                    </div>
                                    <div className="credits-text">
                                        <span>Credits: {totalCredits.toFixed(1)}/100</span>
                                        <span style={{ color: creditsRemaining < 0 ? '#f5576c' : '#56ab2f' }}>{creditsRemaining.toFixed(1)} left</span>
                                    </div>
                                </div>

                                <div className="role-stats">
                                    <div className="role-stat">
                                        <div className="role-label">WK</div>
                                        <div className={`role-count ${roleCounts.WK < DREAM11_RULES.minWK ? 'warning' : 'success'}`}>{roleCounts.WK}</div>
                                        <div style={{ fontSize: '0.7rem', color: '#a0aec0' }}>1-4</div>
                                    </div>
                                    <div className="role-stat">
                                        <div className="role-label">BAT</div>
                                        <div className={`role-count ${roleCounts.BAT < DREAM11_RULES.minBAT ? 'warning' : 'success'}`}>{roleCounts.BAT}</div>
                                        <div style={{ fontSize: '0.7rem', color: '#a0aec0' }}>3-6</div>
                                    </div>
                                    <div className="role-stat">
                                        <div className="role-label">AR</div>
                                        <div className={`role-count ${roleCounts.AR < DREAM11_RULES.minAR ? 'warning' : 'success'}`}>{roleCounts.AR}</div>
                                        <div style={{ fontSize: '0.7rem', color: '#a0aec0' }}>1-4</div>
                                    </div>
                                    <div className="role-stat">
                                        <div className="role-label">BOWL</div>
                                        <div className={`role-count ${roleCounts.BOWL < DREAM11_RULES.minBOWL ? 'warning' : 'success'}`}>{roleCounts.BOWL}</div>
                                        <div style={{ fontSize: '0.7rem', color: '#a0aec0' }}>3-6</div>
                                    </div>
                                </div>

                                {selectedPlayers.length > 0 && (
                                    <>
                                        <div className="captain-selector">
                                            <div className="captain-label">üëë Captain (2x points)</div>
                                            <div className="captain-options">
                                                {selectedPlayers.map(p => (
                                                    <button key={p.id} className={`captain-btn ${captain === p.id ? 'selected' : ''}`} onClick={() => setCaptain(p.id)}>
                                                        {p.name.split(' ').pop()}
                                                    </button>
                                                ))}
                                            </div>
                                        </div>

                                        <div className="captain-selector" style={{ borderColor: '#c6f6d5', background: '#f0fdf4' }}>
                                            <div className="captain-label" style={{ color: '#22543d' }}>‚≠ê Vice Captain (1.5x points)</div>
                                            <div className="captain-options">
                                                {selectedPlayers.filter(p => p.id !== captain).map(p => (
                                                    <button key={p.id} className={`captain-btn ${viceCaptain === p.id ? 'selected' : ''}`} onClick={() => setViceCaptain(p.id)}>
                                                        {p.name.split(' ').pop()}
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                    </>
                                )}

                                <div className="selected-list">
                                    {selectedPlayers.length === 0 ? (
                                        <p style={{ textAlign: 'center', color: '#94a3b8', padding: '20px', fontSize: '0.9rem' }}>Select players to build your team</p>
                                    ) : (
                                        selectedPlayers.map(p => (
                                            <div key={p.id} className="selected-player">
                                                <div>
                                                    <div style={{ fontWeight: '600', fontSize: '0.9rem' }}>
                                                        {p.name}
                                                        {captain === p.id && ' üëë'}
                                                        {viceCaptain === p.id && ' ‚≠ê'}
                                                    </div>
                                                    <div style={{ fontSize: '0.75rem', color: '#718096' }}>{p.role} ‚Ä¢ {TEAM_FLAGS[p.team]} {p.team}</div>
                                                </div>
                                                <div style={{ fontWeight: '700', color: '#667eea' }}>{p.credits}</div>
                                            </div>
                                        ))
                                    )}
                                </div>

                                {!canSaveTeam && selectedPlayers.length > 0 && (
                                    <div className="alert alert-warning" style={{ fontSize: '0.85rem' }}>
                                        {selectedPlayers.length < 11 && '‚ö†Ô∏è Select 11 players\n'}
                                        {!captain && '‚ö†Ô∏è Choose Captain\n'}
                                        {!viceCaptain && '‚ö†Ô∏è Choose Vice-Captain\n'}
                                        {roleCounts.WK < DREAM11_RULES.minWK && '‚ö†Ô∏è Need at least 1 WK\n'}
                                        {roleCounts.BAT < DREAM11_RULES.minBAT && '‚ö†Ô∏è Need at least 3 BAT\n'}
                                        {roleCounts.AR < DREAM11_RULES.minAR && '‚ö†Ô∏è Need at least 1 AR\n'}
                                        {roleCounts.BOWL < DREAM11_RULES.minBOWL && '‚ö†Ô∏è Need at least 3 BOWL'}
                                    </div>
                                )}

                                <button className="btn btn-success" style={{ width: '100%' }} disabled={!canSaveTeam} onClick={saveTeam}>
                                    {canSaveTeam ? '‚úÖ Save Team' : '‚ö†Ô∏è Complete Team'}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        function MyTeams({ user }) {
            const [teams, setTeams] = useState([]);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                loadTeams();
            }, []);

            const loadTeams = async () => {
                try {
                    const { collection, query, where, getDocs } = window.firebaseModules;
                    const q = query(collection(window.firebaseDb, 'teams'), where('userId', '==', user.uid));
                    const snapshot = await getDocs(q);
                    const teamsList = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    setTeams(teamsList);
                } catch (error) {
                    console.error('Error loading teams:', error);
                } finally {
                    setLoading(false);
                }
            };

            if (loading) {
                return <div className="card"><div className="loading">Loading your teams</div></div>;
            }

            return (
                <div className="card">
                    <h2>üë• My Teams ({teams.length})</h2>
                    
                    {teams.length === 0 ? (
                        <div className="alert alert-info">You haven't created any teams yet. Go to Matches to create your first team!</div>
                    ) : (
                        <div style={{ display: 'flex', flexDirection: 'column', gap: '20px' }}>
                            {teams.map(team => (
                                <div key={team.id} style={{ background: 'linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%)', border: '2px solid #e2e8f0', borderRadius: '14px', padding: '20px' }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>
                                        <h3 style={{ margin: 0, fontSize: '1.2rem', color: '#2d3748' }}>{team.matchName}</h3>
                                        <div style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', color: 'white', padding: '6px 14px', borderRadius: '8px', fontWeight: '700' }}>
                                            {team.totalCredits.toFixed(1)} Credits
                                        </div>
                                    </div>

                                    <div className="players-grid">
                                        {team.players.map(player => (
                                            <div key={player.id} className="player-card selected">
                                                <div className="player-header">
                                                    <div>
                                                        <div className="player-name">
                                                            {player.name}
                                                            {team.captain === player.id && ' üëë'}
                                                            {team.viceCaptain === player.id && ' ‚≠ê'}
                                                        </div>
                                                        <div className="player-team">{TEAM_FLAGS[player.team]} {TEAM_NAMES[player.team]}</div>
                                                    </div>
                                                    <div className="player-credits">{player.credits}</div>
                                                </div>
                                                <div className="player-role">{player.role}</div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        }

        function Leaderboard() {
            const sampleData = [
                { rank: 1, username: 'cricket_queen', points: 2450, teams: 5 },
                { rank: 2, username: 'fantasy_champion', points: 2280, teams: 4 },
                { rank: 3, username: 'wt20_master', points: 2120, teams: 6 },
                { rank: 4, username: 'player_pro', points: 1980, teams: 3 },
                { rank: 5, username: 'sports_legend', points: 1850, teams: 4 }
            ];

            return (
                <div className="card">
                    <h2>üìä Leaderboard</h2>
                    
                    <div style={{ overflowX: 'auto' }}>
                        <table style={{ width: '100%', borderCollapse: 'separate', borderSpacing: '0 10px' }}>
                            <thead>
                                <tr style={{ background: 'linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%)', color: '#4a5568' }}>
                                    <th style={{ padding: '16px', textAlign: 'left', borderRadius: '10px 0 0 10px' }}>Rank</th>
                                    <th style={{ padding: '16px', textAlign: 'left' }}>Username</th>
                                    <th style={{ padding: '16px', textAlign: 'left' }}>Points</th>
                                    <th style={{ padding: '16px', textAlign: 'left', borderRadius: '0 10px 10px 0' }}>Teams</th>
                                </tr>
                            </thead>
                            <tbody>
                                {sampleData.map(entry => (
                                    <tr key={entry.rank} style={{ background: 'white', boxShadow: '0 2px 8px rgba(0,0,0,0.05)' }}>
                                        <td style={{ padding: '16px', borderRadius: '10px 0 0 10px' }}>
                                            <span style={{ display: 'inline-block', width: '40px', height: '40px', lineHeight: '40px', textAlign: 'center', borderRadius: '50%', fontWeight: '800', background: entry.rank <= 3 ? 'linear-gradient(135deg, #ffd700 0%, #ffed4e 100%)' : '#f7fafc', color: entry.rank <= 3 ? '#744210' : '#4a5568' }}>
                                                {entry.rank}
                                            </span>
                                        </td>
                                        <td style={{ padding: '16px', fontWeight: '600' }}>{entry.username}</td>
                                        <td style={{ padding: '16px', color: '#667eea', fontWeight: '700', fontSize: '1.1rem' }}>{entry.points.toLocaleString()}</td>
                                        <td style={{ padding: '16px', borderRadius: '0 10px 10px 0' }}>{entry.teams}</td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
